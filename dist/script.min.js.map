{
  "version": 3,
  "sources": ["../script.js"],
  "sourcesContent": ["// Firebase configuration\nconst firebaseConfig = {\n  apiKey: \"AIzaSyA-KsOZhIGr7xCBExOBOmDUQmVL9neWJ2Y\",\n  authDomain: \"taskschedule-pro.firebaseapp.com\",\n  databaseURL: \"https://taskschedule-pro-default-rtdb.firebaseio.com\",\n  projectId: \"taskschedule-pro\",\n  storageBucket: \"taskschedule-pro.firebasestorage.app\",\n  messagingSenderId: \"786531666672\",\n  appId: \"1:786531666672:web:debae6aaa19dcf4f2b5035\",\n  measurementId: \"G-MDS6Y5FMGT\",\n};\n\n// Initialize Firebase\ntry {\n  firebase.initializeApp(firebaseConfig);\n  console.log(\"Firebase initialized successfully\");\n} catch (error) {\n  console.error(\"Firebase initialization error:\", error);\n}\n\n// Initialize Firestore\nconst db = firebase.firestore();\n\n// Initialize Firebase Auth\nconst auth = firebase.auth();\n\n// Global variables\nlet tasks = [];\nlet currentEditingTaskId = null;\nlet currentUser = null;\nlet currentView = \"kanban\";\nlet currentMonth = new Date().getMonth();\nlet currentYear = new Date().getFullYear();\nlet currentFilter = \"all\";\nlet currentTagFilter = \"all\";\nlet currentSort = \"date-added-desc\";\nlet searchQuery = \"\";\n\n// DOM Elements\nconst elements = {\n  // Forms\n  taskForm: document.querySelector(\".task-form\"),\n  taskTitle: document.getElementById(\"task-title\"),\n  taskDescription: document.getElementById(\"task-description\"),\n  taskDueDate: document.getElementById(\"task-due-date\"),\n  taskStartTime: document.getElementById(\"task-start-time\"),\n  taskEndTime: document.getElementById(\"task-end-time\"),\n  taskRecurrence: document.getElementById(\"task-recurrence\"),\n  taskDifficulty: document.getElementById(\"task-difficulty\"),\n  taskCheckpoints: document.getElementById(\"task-checkpoints\"),\n  taskTags: document.getElementById(\"task-tags\"),\n  taskReminder: document.getElementById(\"task-reminder\"),\n\n  // Buttons\n  addTaskBtn: document.getElementById(\"add-task\"),\n  saveTaskBtn: document.getElementById(\"save-task\"),\n  toggleFormBtn: document.getElementById(\"toggle-form\"),\n  modeToggle: document.getElementById(\"mode-toggle\"),\n  viewToggle: document.getElementById(\"view-toggle\"),\n  helpBtn: document.getElementById(\"help-btn\"),\n  authBtn: document.getElementById(\"auth-btn\"),\n  settingsBtn: document.getElementById(\"settings-btn\"),\n  exportBtn: document.getElementById(\"export-btn\"),\n  importBtn: document.getElementById(\"import-btn\"),\n  importFile: document.getElementById(\"import-file\"),\n  archiveCompletedBtn: document.getElementById(\"archive-completed\"),\n  showArchivedBtn: document.getElementById(\"show-archived\"),\n  showAllBtn: document.getElementById(\"show-all\"),\n  showActiveBtn: document.getElementById(\"show-active\"),\n  showCompletedBtn: document.getElementById(\"show-completed\"),\n  clearCompletedBtn: document.getElementById(\"clear-completed\"),\n\n  // Modals\n  taskModal: document.getElementById(\"task-modal-overlay\"),\n  helpModal: document.getElementById(\"help-modal-overlay\"),\n  authModal: document.getElementById(\"auth-modal-overlay\"),\n  settingsModal: document.getElementById(\"settings-modal-overlay\"),\n  archiveModal: document.getElementById(\"archive-modal-overlay\"),\n  profileModal: document.getElementById(\"profile-modal-overlay\"),\n\n  // Modal buttons\n  closeModalBtns: document.querySelectorAll(\".close-modal\"),\n  closeHelpModal: document.getElementById(\"close-help-modal\"),\n  closeAuthModal: document.getElementById(\"close-auth-modal\"),\n  closeSettingsModal: document.getElementById(\"close-settings-modal\"),\n  closeArchiveModal: document.getElementById(\"close-archive-modal\"),\n  closeProfileModal: document.getElementById(\"close-profile-modal\"),\n  saveChangesBtn: document.getElementById(\"save-changes\"),\n  deleteTaskBtn: document.getElementById(\"delete-task\"),\n  archiveTaskBtn: document.getElementById(\"archive-task\"),\n\n  // Modal form elements\n  modalTaskTitle: document.getElementById(\"modal-task-title\"),\n  modalTaskDescription: document.getElementById(\"modal-task-description\"),\n  modalTaskDueDate: document.getElementById(\"modal-task-due-date\"),\n  modalTaskRecurrence: document.getElementById(\"modal-task-recurrence\"),\n  modalTaskDifficulty: document.getElementById(\"modal-task-difficulty\"),\n  modalTaskStartTime: document.getElementById(\"modal-task-start-time\"),\n  modalTaskEndTime: document.getElementById(\"modal-task-end-time\"),\n  modalTaskTags: document.getElementById(\"modal-task-tags\"),\n  modalTaskReminder: document.getElementById(\"modal-task-reminder\"),\n  modalCheckpoints: document.getElementById(\"modal-checkpoints\"),\n\n  // Auth elements\n  loginForm: document.getElementById(\"login-form\"),\n  signupForm: document.getElementById(\"signup-form\"),\n  loginEmail: document.getElementById(\"login-email\"),\n  loginPassword: document.getElementById(\"login-password\"),\n  signupUsername: document.getElementById(\"signup-username\"),\n  signupEmail: document.getElementById(\"signup-email\"),\n  signupPassword: document.getElementById(\"signup-password\"),\n  signupConfirmPassword: document.getElementById(\"signup-confirm-password\"),\n  loginBtn: document.getElementById(\"login-btn\"),\n  registerBtn: document.getElementById(\"register-btn\"),\n  googleLogin: document.getElementById(\"google-login\"),\n  googleRegister: document.getElementById(\"google-register\"),\n  switchToSignup: document.getElementById(\"switch-to-signup\"),\n  switchToLogin: document.getElementById(\"switch-to-login\"),\n  loginStatus: document.getElementById(\"login-status\"),\n  registerStatus: document.getElementById(\"register-status\"),\n\n  // Settings elements\n  defaultTheme: document.getElementById(\"default-theme\"),\n  defaultView: document.getElementById(\"default-view\"),\n  reduceMotion: document.getElementById(\"reduce-motion\"),\n  disableAnimations: document.getElementById(\"disable-animations\"),\n  saveSettingsBtn: document.getElementById(\"save-settings\"),\n\n  // Profile elements\n  profileName: document.getElementById(\"profile-name\"),\n  profileEmail: document.getElementById(\"profile-email\"),\n  profilePassword: document.getElementById(\"profile-password\"),\n  updateProfileBtn: document.getElementById(\"update-profile\"),\n  logoutBtn: document.getElementById(\"logout-btn\"),\n\n  // Task lists\n  todoList: document.getElementById(\"todo-list\"),\n  inProgressList: document.getElementById(\"in-progress-list\"),\n  doneList: document.getElementById(\"done-list\"),\n  archivedTasksList: document.getElementById(\"archived-tasks-list\"),\n\n  // Stats\n  totalTasks: document.getElementById(\"total-tasks\"),\n  completedTasks: document.getElementById(\"completed-tasks\"),\n  inprogressTasks: document.getElementById(\"inprogress-tasks\"),\n  overdueTasks: document.getElementById(\"overdue-tasks\"),\n  overallProgress: document.getElementById(\"overall-progress\"),\n\n  // Calendar\n  calendarView: document.getElementById(\"calendar-view\"),\n  kanbanView: document.getElementById(\"kanban-view\"),\n  calendarMonthYear: document.getElementById(\"calendar-month-year\"),\n  calendarGrid: document.getElementById(\"calendar-grid\"),\n  prevMonth: document.getElementById(\"prev-month\"),\n  nextMonth: document.getElementById(\"next-month\"),\n\n  // Search and filters\n  searchInput: document.getElementById(\"search-input\"),\n  sortSelect: document.getElementById(\"sort-select\"),\n  tagsFilter: document.getElementById(\"tags-filter\"),\n\n  // Notification\n  notification: document.getElementById(\"notification\"),\n  notificationIcon: document.getElementById(\"notification-icon\"),\n  notificationMessage: document.getElementById(\"notification-message\"),\n  notificationAction: document.getElementById(\"notification-action\"),\n\n  // Importance selector\n  importanceOptions: document.querySelectorAll(\".importance-option\"),\n  modalImportanceOptions: document.querySelectorAll(\n    \".modal-actions .importance-option\"\n  ),\n};\n\n// Get tag color from custom tags\nfunction getTagColor(tagName) {\n  const tagConfig = customTags.find((t) => t.name === tagName);\n  return tagConfig ? tagConfig.color : \"#6c5ce7\";\n}\n\n// Get current selected tags from task form\nfunction getCurrentTags() {\n  const taskTagsSelect = document.getElementById(\"task-tags\");\n  if (!taskTagsSelect) return [];\n\n  return Array.from(taskTagsSelect.selectedOptions).map(option => option.value);\n}\n\n// Get current selected tags from modal form\nfunction getCurrentModalTags() {\n  const modalTaskTags = document.getElementById(\"modal-task-tags\");\n  if (!modalTaskTags) return [];\n\n  return Array.from(modalTaskTags.selectedOptions).map(option => option.value);\n}\n\n// Clear form tags selection\nfunction clearFormTags() {\n  const taskTagsSelect = document.getElementById(\"task-tags\");\n  if (taskTagsSelect) {\n    Array.from(taskTagsSelect.options).forEach(option => {\n      option.selected = false;\n    });\n  }\n}\n\n// List View Rendering\nfunction renderListView() {\n  const container = document.getElementById(\"list-container\");\n  if (!container) return;\n\n  container.innerHTML = \"\";\n\n  const activeTasks = tasks.filter((task) => !task.archived && !task.deleted);\n\n  if (activeTasks.length === 0) {\n    container.innerHTML =\n      '<div class=\"empty-state\"><i class=\"fas fa-list\"></i><p>No tasks found</p></div>';\n    return;\n  }\n\n  activeTasks.forEach((task) => {\n    const item = document.createElement(\"div\");\n    item.className = \"list-task-item\";\n\n    const priorityClass =\n      task.importance === 3\n        ? \"task-card-priority-high\"\n        : task.importance === 2\n        ? \"task-card-priority-medium\"\n        : \"task-card-priority-low\";\n    item.classList.add(priorityClass);\n\n    item.innerHTML = `\n      <input type=\"checkbox\" class=\"list-task-checkbox\" ${\n        task.status === \"done\" ? \"checked\" : \"\"\n      }>\n      <div class=\"list-task-content\">\n        <div class=\"list-task-title\">${task.title}</div>\n        <div class=\"list-task-meta\">\n          <span class=\"task-difficulty ${task.difficulty}\">${\n      task.difficulty\n    }</span>\n          <span class=\"task-date\">${task.dueDate || \"No due date\"}</span>\n          <span class=\"task-importance\" data-importance=\"${task.importance}\">${\n      task.importance\n    }</span>\n        </div>\n      </div>\n    `;\n\n    item\n      .querySelector(\".list-task-checkbox\")\n      .addEventListener(\"change\", (e) => {\n        updateTaskStatus(task.id, e.target.checked ? \"done\" : \"todo\");\n      });\n\n    item.addEventListener(\"click\", (e) => {\n      if (e.target.type !== \"checkbox\") {\n        editTask(task.id);\n      }\n    });\n\n    container.appendChild(item);\n  });\n}\n\n// Grid View Rendering\nfunction renderGridView() {\n  const container = document.getElementById(\"grid-container\");\n  if (!container) return;\n\n  container.innerHTML = \"\";\n\n  const activeTasks = tasks.filter((task) => !task.archived && !task.deleted);\n\n  if (activeTasks.length === 0) {\n    container.innerHTML =\n      '<div class=\"empty-state\"><i class=\"fas fa-th\"></i><p>No tasks found</p></div>';\n    return;\n  }\n\n  activeTasks.forEach((task) => {\n    const card = createTaskElement(task);\n    card.classList.add(\"grid-task-card\");\n    container.appendChild(card);\n  });\n}\n\n// Timeline View Rendering\nfunction renderTimelineView() {\n  const container = document.getElementById(\"timeline-container\");\n  if (!container) return;\n\n  container.innerHTML = \"\";\n\n  const activeTasks = tasks.filter(\n    (task) => !task.archived && !task.deleted && task.dueDate\n  );\n\n  if (activeTasks.length === 0) {\n    container.innerHTML =\n      '<div class=\"empty-state\"><i class=\"fas fa-stream\"></i><p>No tasks with due dates found</p></div>';\n    return;\n  }\n\n  // Sort by due date\n  activeTasks.sort((a, b) => new Date(a.dueDate) - new Date(b.dueDate));\n\n  activeTasks.forEach((task) => {\n    const item = document.createElement(\"div\");\n    item.className = \"timeline-item\";\n\n    item.innerHTML = `\n      <div class=\"timeline-date\">${new Date(task.dueDate).toLocaleDateString(\n        \"en-US\",\n        { weekday: \"long\", year: \"numeric\", month: \"long\", day: \"numeric\" }\n      )}</div>\n      <h3 class=\"task-title\">${task.title}</h3>\n      <p class=\"task-description\">${task.description || \"No description\"}</p>\n      <div class=\"task-meta\">\n        <span class=\"task-difficulty ${task.difficulty}\">${\n      task.difficulty\n    }</span>\n        <span class=\"task-importance\" data-importance=\"${task.importance}\">${\n      task.importance\n    }</span>\n      </div>\n    `;\n\n    item.addEventListener(\"click\", () => editTask(task.id));\n    container.appendChild(item);\n  });\n}\n\n// Initialize the application\nfunction init() {\n  console.log(\"\uD83D\uDE80 Initializing SchedulePro App...\");\n\n  // Set up event listeners\n  console.log(\"  \u2699\uFE0F Setting up event listeners...\");\n  setupEventListeners();\n\n  // Set default due date to today\n  const today = new Date().toISOString().split(\"T\")[0];\n  elements.taskDueDate.value = today;\n  console.log(\"  \uD83D\uDCC5 Default due date set to:\", today);\n\n  // Load tasks from local storage\n  console.log(\"  \uD83D\uDCBE Loading tasks from local storage...\");\n  loadTasksFromLocalStorage();\n\n  // Render tasks\n  console.log(\"  \uD83C\uDFA8 Rendering tasks...\");\n  renderTasks();\n\n  // Update statistics\n  console.log(\"  \uD83D\uDCCA Updating statistics...\");\n  updateStats();\n\n  // Set up drag and drop\n  console.log(\"  \uD83D\uDDB1\uFE0F Setting up drag and drop...\");\n  setupDragAndDrop();\n\n  // Check authentication state\n  console.log(\"  \uD83D\uDD10 Checking authentication state...\");\n  checkAuthState();\n\n  // Load settings\n  console.log(\"  \u2699\uFE0F Loading settings...\");\n  loadSettings();\n\n  // Generate calendar\n  console.log(\"  \uD83D\uDCC6 Generating calendar...\");\n  generateCalendar(currentMonth, currentYear);\n\n  console.log(\"\u2705 App initialized successfully\");\n}\n\n// Initialize charts when window is fully loaded\nwindow.addEventListener(\"load\", () => {\n  console.log(\"Window loaded, initializing charts...\");\n  setTimeout(() => {\n    initCharts();\n  }, 300);\n});\n\n// Set up all event listeners\nfunction setupEventListeners() {\n  console.log(\"Setting up event listeners...\");\n\n  // Form submission\n  elements.addTaskBtn.addEventListener(\"click\", addTask);\n  elements.saveTaskBtn.addEventListener(\"click\", saveTask);\n  elements.toggleFormBtn.addEventListener(\"click\", toggleForm);\n\n  // Modal controls\n  elements.closeModalBtns.forEach((btn) => {\n    btn.addEventListener(\"click\", closeAllModals);\n  });\n\n  if (elements.closeHelpModal) {\n    elements.closeHelpModal.addEventListener(\"click\", () =>\n      closeModal(elements.helpModal)\n    );\n  }\n\n  if (elements.closeAuthModal) {\n    elements.closeAuthModal.addEventListener(\"click\", () =>\n      closeModal(elements.authModal)\n    );\n  }\n\n  if (elements.closeSettingsModal) {\n    elements.closeSettingsModal.addEventListener(\"click\", () =>\n      closeModal(elements.settingsModal)\n    );\n  }\n\n  if (elements.closeArchiveModal) {\n    elements.closeArchiveModal.addEventListener(\"click\", () =>\n      closeModal(elements.archiveModal)\n    );\n  }\n\n  if (elements.closeProfileModal) {\n    elements.closeProfileModal.addEventListener(\"click\", () =>\n      closeModal(elements.profileModal)\n    );\n  }\n\n  // Modal actions\n  elements.saveChangesBtn.addEventListener(\"click\", updateTask);\n  elements.deleteTaskBtn.addEventListener(\"click\", deleteTask);\n  elements.archiveTaskBtn.addEventListener(\"click\", archiveTask);\n\n  // UI controls\n  if (elements.viewToggle) {\n    elements.viewToggle.addEventListener(\"click\", toggleView);\n  }\n\n  if (elements.helpBtn) {\n    elements.helpBtn.addEventListener(\"click\", () => {\n      console.log(\"Help button clicked\");\n      openModal(elements.helpModal);\n    });\n  } else {\n    console.warn(\"Help button not found\");\n  }\n\n  if (elements.authBtn) {\n    elements.authBtn.addEventListener(\"click\", () => {\n      console.log(\"Auth button clicked\");\n      openModal(elements.authModal);\n    });\n  } else {\n    console.warn(\"Auth button not found\");\n  }\n\n  if (elements.settingsBtn) {\n    elements.settingsBtn.addEventListener(\"click\", () => {\n      console.log(\"Settings button clicked\");\n      // Update settings modal with current values before opening\n      elements.defaultTheme.value = currentTheme;\n      openModal(elements.settingsModal);\n    });\n  } else {\n    console.warn(\"Settings button not found\");\n  }\n  elements.showArchivedBtn.addEventListener(\"click\", showArchivedTasks);\n  elements.exportBtn.addEventListener(\"click\", exportTasks);\n  elements.importBtn.addEventListener(\"click\", () =>\n    elements.importFile.click()\n  );\n  elements.importFile.addEventListener(\"change\", importTasks);\n  elements.archiveCompletedBtn.addEventListener(\"click\", archiveCompletedTasks);\n  elements.showAllBtn.addEventListener(\"click\", () => filterTasks(\"all\"));\n  elements.showActiveBtn.addEventListener(\"click\", () => filterTasks(\"active\"));\n  elements.showCompletedBtn.addEventListener(\"click\", () =>\n    filterTasks(\"completed\")\n  );\n  elements.clearCompletedBtn.addEventListener(\"click\", clearCompletedTasks);\n\n  // Auth events\n  elements.loginForm.addEventListener(\"submit\", (e) => {\n    e.preventDefault();\n    loginUser();\n  });\n\n  elements.signupForm.addEventListener(\"submit\", (e) => {\n    e.preventDefault();\n    registerUser();\n  });\n\n  elements.switchToSignup.addEventListener(\"click\", (e) => {\n    e.preventDefault();\n    switchAuthForm(\"signup\");\n  });\n\n  elements.switchToLogin.addEventListener(\"click\", (e) => {\n    e.preventDefault();\n    switchAuthForm(\"login\");\n  });\n\n  elements.googleLogin.addEventListener(\"click\", signInWithGoogle);\n  elements.googleRegister.addEventListener(\"click\", signInWithGoogle);\n\n  // Settings events\n  elements.saveSettingsBtn.addEventListener(\"click\", saveSettings);\n\n  // Profile events\n  elements.updateProfileBtn.addEventListener(\"click\", updateProfile);\n  elements.logoutBtn.addEventListener(\"click\", logoutUser);\n\n  // Calendar events\n  elements.prevMonth.addEventListener(\"click\", () => changeMonth(-1));\n  elements.nextMonth.addEventListener(\"click\", () => changeMonth(1));\n\n  // Search and filter events\n  elements.searchInput.addEventListener(\"input\", (e) => {\n    searchQuery = e.target.value.toLowerCase();\n    filterAndRenderTasks();\n  });\n\n  elements.sortSelect.addEventListener(\"change\", (e) => {\n    currentSort = e.target.value;\n    filterAndRenderTasks();\n  });\n\n  elements.tagsFilter.addEventListener(\"change\", (e) => {\n    currentTagFilter = e.target.value;\n    filterAndRenderTasks();\n  });\n\n  // Importance selection\n  elements.importanceOptions.forEach((option) => {\n    option.addEventListener(\"click\", () =>\n      selectImportance(option, elements.importanceOptions)\n    );\n  });\n\n  elements.modalImportanceOptions.forEach((option) => {\n    option.addEventListener(\"click\", () =>\n      selectImportance(option, elements.modalImportanceOptions)\n    );\n  });\n\n  // Close modals when clicking outside\n  document.addEventListener(\"click\", (e) => {\n    if (e.target.classList.contains(\"modal-overlay\")) {\n      closeAllModals();\n    }\n  });\n\n  // Keyboard shortcuts\n  document.addEventListener(\"keydown\", handleKeyboardShortcuts);\n\n  // Notification dismiss button\n  if (elements.notificationAction) {\n    elements.notificationAction.addEventListener(\"click\", (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      console.log(\"\uD83D\uDD14 Dismiss button clicked\");\n      if (elements.notification) {\n        elements.notification.classList.remove(\"show\");\n        console.log(\"  \u2713 Notification hidden\");\n      }\n    });\n    console.log(\"\u2705 Notification dismiss button initialized\");\n  } else {\n    console.warn(\"\u26A0\uFE0F Notification action button not found\");\n  }\n\n  console.log(\"Event listeners set up successfully\");\n}\n\n// Check authentication state\nfunction checkAuthState() {\n  auth.onAuthStateChanged((user) => {\n    if (user) {\n      // User is signed in\n      currentUser = user;\n      elements.authBtn.innerHTML = '<i class=\"fas fa-user\"></i>Profile';\n      elements.authBtn.removeEventListener(\"click\", () =>\n        openModal(elements.authModal)\n      );\n      elements.authBtn.addEventListener(\"click\", () =>\n        openModal(elements.profileModal)\n      );\n\n      // Load user tasks\n      loadTasks();\n\n      // Update profile info\n      elements.profileName.value = user.displayName || \"\";\n      elements.profileEmail.value = user.email;\n\n      showNotification(\"Successfully signed in!\", \"success\");\n    } else {\n      // User is signed out\n      currentUser = null;\n      elements.authBtn.innerHTML = '<i class=\"fas fa-user\"></i>Login';\n      elements.authBtn.removeEventListener(\"click\", () =>\n        openModal(elements.profileModal)\n      );\n      elements.authBtn.addEventListener(\"click\", () =>\n        openModal(elements.authModal)\n      );\n\n      // Clear tasks\n      tasks = [];\n      renderTasks();\n      updateStats();\n\n      showNotification(\"Signed out successfully\", \"info\");\n    }\n  });\n}\n\n// Load tasks from Firestore\nfunction loadTasks() {\n  if (!currentUser) {\n    console.log(\"No user logged in, cannot load tasks\");\n    return;\n  }\n\n  console.log(\"Loading tasks for user:\", currentUser.uid);\n\n  db.collection(\"users\")\n    .doc(currentUser.uid)\n    .collection(\"tasks\")\n    .orderBy(\"createdAt\", \"desc\")\n    .onSnapshot(\n      (snapshot) => {\n        tasks = [];\n        snapshot.forEach((doc) => {\n          const task = doc.data();\n          task.id = doc.id;\n          tasks.push(task);\n        });\n\n        console.log(`Loaded ${tasks.length} tasks`);\n        filterAndRenderTasks();\n        updateStats();\n        generateCalendar(currentMonth, currentYear);\n        updateCharts();\n      },\n      (error) => {\n        console.error(\"Error loading tasks:\", error);\n        showNotification(\"Error loading tasks\", \"error\");\n      }\n    );\n}\n\n// Add a new task\nfunction addTask() {\n  console.log(\"Adding new task...\");\n\n  // Validate form\n  if (!elements.taskTitle.value.trim()) {\n    showNotification(\"Task title is required\", \"error\");\n    elements.taskTitle.focus();\n    return;\n  }\n\n  // Get form values\n  const title = elements.taskTitle.value.trim();\n  const description = elements.taskDescription.value.trim();\n  const dueDate = elements.taskDueDate.value;\n  const startTime = elements.taskStartTime.value;\n  const endTime = elements.taskEndTime.value;\n  const recurrence = elements.taskRecurrence.value;\n  const difficulty = elements.taskDifficulty.value;\n  const reminder = elements.taskReminder.value;\n\n  // Get selected importance\n  const selectedImportance = document.querySelector(\n    \".importance-option.selected\"\n  );\n  const importance = selectedImportance\n    ? parseInt(selectedImportance.dataset.importance)\n    : 1;\n\n  // Get checkpoints\n  const checkpointsText = elements.taskCheckpoints.value.trim();\n  const checkpoints = checkpointsText\n    ? checkpointsText.split(\"\\n\").map((cp) => ({\n        text: cp.trim(),\n        completed: false,\n      }))\n    : [];\n\n  // Get selected tags from custom tags input\n  const selectedTags = getCurrentTags();\n\n  // Calculate progress based on checkpoints\n  const progress =\n    checkpoints.length > 0\n      ? Math.round(\n          (checkpoints.filter((cp) => cp.completed).length /\n            checkpoints.length) *\n            100\n        )\n      : 0;\n\n  // Create task object\n  const task = {\n    title,\n    description,\n    dueDate,\n    startTime,\n    endTime,\n    recurrence,\n    difficulty,\n    importance,\n    checkpoints,\n    tags: selectedTags,\n    reminder,\n    progress,\n    status: \"todo\",\n    createdAt: firebase.firestore.FieldValue.serverTimestamp(),\n    updatedAt: firebase.firestore.FieldValue.serverTimestamp(),\n    archived: false,\n  };\n\n  // Add to Firestore if user is logged in, otherwise to local storage\n  if (currentUser) {\n    db.collection(\"users\")\n      .doc(currentUser.uid)\n      .collection(\"tasks\")\n      .add(task)\n      .then((docRef) => {\n        console.log(\"Task added with ID: \", docRef.id);\n        showNotification(\"Task added successfully!\", \"success\");\n        resetForm();\n      })\n      .catch((error) => {\n        console.error(\"Error adding task: \", error);\n        showNotification(\"Error adding task\", \"error\");\n      });\n  } else {\n    // Local storage fallback\n    task.id = \"local-\" + Date.now();\n    tasks.push(task);\n    saveTasksToLocalStorage();\n    renderTasks();\n    updateStats();\n    showNotification(\"Task added successfully!\", \"success\");\n    resetForm();\n  }\n}\n\n// Save task (update existing)\nfunction saveTask() {\n  if (!currentEditingTaskId) return;\n\n  console.log(\"Saving task:\", currentEditingTaskId);\n\n  // Get form values\n  const title = elements.taskTitle.value.trim();\n  const description = elements.taskDescription.value.trim();\n  const dueDate = elements.taskDueDate.value;\n  const startTime = elements.taskStartTime.value;\n  const endTime = elements.taskEndTime.value;\n  const recurrence = elements.taskRecurrence.value;\n  const difficulty = elements.taskDifficulty.value;\n  const reminder = elements.taskReminder.value;\n\n  // Get selected importance\n  const selectedImportance = document.querySelector(\n    \".importance-option.selected\"\n  );\n  const importance = selectedImportance\n    ? parseInt(selectedImportance.dataset.importance)\n    : 1;\n\n  // Get checkpoints\n  const checkpointsText = elements.taskCheckpoints.value.trim();\n  const checkpoints = checkpointsText\n    ? checkpointsText.split(\"\\n\").map((cp) => ({\n        text: cp.trim(),\n        completed: false,\n      }))\n    : [];\n\n  // Get selected tags from custom tags input (for save task)\n  const selectedTags = getCurrentTags();\n\n  // Calculate progress based on checkpoints\n  const progress =\n    checkpoints.length > 0\n      ? Math.round(\n          (checkpoints.filter((cp) => cp.completed).length /\n            checkpoints.length) *\n            100\n        )\n      : 0;\n\n  // Update task object\n  const updatedTask = {\n    title,\n    description,\n    dueDate,\n    startTime,\n    endTime,\n    recurrence,\n    difficulty,\n    importance,\n    checkpoints,\n    tags: selectedTags,\n    reminder,\n    progress,\n    updatedAt: firebase.firestore.FieldValue.serverTimestamp(),\n  };\n\n  // Update in Firestore if user is logged in, otherwise in local storage\n  if (currentUser) {\n    db.collection(\"users\")\n      .doc(currentUser.uid)\n      .collection(\"tasks\")\n      .doc(currentEditingTaskId)\n      .update(updatedTask)\n      .then(() => {\n        console.log(\"Task updated successfully\");\n        showNotification(\"Task updated successfully!\", \"success\");\n        resetForm();\n        closeModal(elements.taskModal);\n      })\n      .catch((error) => {\n        console.error(\"Error updating task: \", error);\n        showNotification(\"Error updating task\", \"error\");\n      });\n  } else {\n    // Local storage fallback\n    const taskIndex = tasks.findIndex(\n      (task) => task.id === currentEditingTaskId\n    );\n    if (taskIndex !== -1) {\n      tasks[taskIndex] = { ...tasks[taskIndex], ...updatedTask };\n      saveTasksToLocalStorage();\n      renderTasks();\n      updateStats();\n      showNotification(\"Task updated successfully!\", \"success\");\n      resetForm();\n      closeModal(elements.taskModal);\n    }\n  }\n}\n\n// Update task from modal\nfunction updateTask() {\n  if (!currentEditingTaskId) return;\n\n  console.log(\"Updating task:\", currentEditingTaskId);\n\n  // Get modal form values\n  const title = elements.modalTaskTitle.value.trim();\n  const description = elements.modalTaskDescription.value.trim();\n  const dueDate = elements.modalTaskDueDate.value;\n  const startTime = elements.modalTaskStartTime.value;\n  const endTime = elements.modalTaskEndTime.value;\n  const recurrence = elements.modalTaskRecurrence.value;\n  const difficulty = elements.modalTaskDifficulty.value;\n  const reminder = elements.modalTaskReminder.value;\n\n  // Get selected importance from modal\n  const selectedImportance = document.querySelector(\n    \".modal-actions .importance-option.selected\"\n  );\n  const importance = selectedImportance\n    ? parseInt(selectedImportance.dataset.importance)\n    : 1;\n\n  // Get selected tags from modal custom input\n  const selectedTags = getCurrentModalTags();\n\n  // Get checkpoints status from modal\n  const checkpoints = [];\n  const checkpointElements =\n    elements.modalCheckpoints.querySelectorAll(\".checkpoint-item\");\n  checkpointElements.forEach((el) => {\n    const checkbox = el.querySelector('input[type=\"checkbox\"]');\n    const text = el.querySelector(\".checkpoint-text\").textContent;\n    checkpoints.push({\n      text: text,\n      completed: checkbox.checked,\n    });\n  });\n\n  // Calculate progress based on checkpoints\n  const progress =\n    checkpoints.length > 0\n      ? Math.round(\n          (checkpoints.filter((cp) => cp.completed).length /\n            checkpoints.length) *\n            100\n        )\n      : 0;\n\n  // Update task object\n  const updatedTask = {\n    title,\n    description,\n    dueDate,\n    startTime,\n    endTime,\n    recurrence,\n    difficulty,\n    importance,\n    checkpoints,\n    tags: selectedTags,\n    reminder,\n    progress,\n    updatedAt: firebase.firestore.FieldValue.serverTimestamp(),\n  };\n\n  // Update in Firestore if user is logged in, otherwise in local storage\n  if (currentUser) {\n    db.collection(\"users\")\n      .doc(currentUser.uid)\n      .collection(\"tasks\")\n      .doc(currentEditingTaskId)\n      .update(updatedTask)\n      .then(() => {\n        console.log(\"Task updated successfully\");\n        showNotification(\"Task updated successfully!\", \"success\");\n        closeModal(elements.taskModal);\n      })\n      .catch((error) => {\n        console.error(\"Error updating task: \", error);\n        showNotification(\"Error updating task\", \"error\");\n      });\n  } else {\n    // Local storage fallback\n    const taskIndex = tasks.findIndex(\n      (task) => task.id === currentEditingTaskId\n    );\n    if (taskIndex !== -1) {\n      tasks[taskIndex] = { ...tasks[taskIndex], ...updatedTask };\n      saveTasksToLocalStorage();\n      renderTasks();\n      updateStats();\n      showNotification(\"Task updated successfully!\", \"success\");\n      closeModal(elements.taskModal);\n    }\n  }\n}\n\n// Delete task\nfunction deleteTask() {\n  if (!currentEditingTaskId) return;\n\n  if (confirm(\"Are you sure you want to delete this task?\")) {\n    if (currentUser) {\n      db.collection(\"users\")\n        .doc(currentUser.uid)\n        .collection(\"tasks\")\n        .doc(currentEditingTaskId)\n        .delete()\n        .then(() => {\n          console.log(\"Task deleted successfully\");\n          showNotification(\"Task deleted successfully!\", \"success\");\n          closeModal(elements.taskModal);\n        })\n        .catch((error) => {\n          console.error(\"Error deleting task: \", error);\n          showNotification(\"Error deleting task\", \"error\");\n        });\n    } else {\n      // Local storage fallback\n      tasks = tasks.filter((task) => task.id !== currentEditingTaskId);\n      saveTasksToLocalStorage();\n      renderTasks();\n      updateStats();\n      showNotification(\"Task deleted successfully!\", \"success\");\n      closeModal(elements.taskModal);\n    }\n  }\n}\n\n// Archive task\nfunction archiveTask() {\n  if (!currentEditingTaskId) return;\n\n  if (currentUser) {\n    db.collection(\"users\")\n      .doc(currentUser.uid)\n      .collection(\"tasks\")\n      .doc(currentEditingTaskId)\n      .update({\n        archived: true,\n        updatedAt: firebase.firestore.FieldValue.serverTimestamp(),\n      })\n      .then(() => {\n        console.log(\"Task archived successfully\");\n        showNotification(\"Task archived successfully!\", \"success\");\n        closeModal(elements.taskModal);\n      })\n      .catch((error) => {\n        console.error(\"Error archiving task: \", error);\n        showNotification(\"Error archiving task\", \"error\");\n      });\n  } else {\n    // Local storage fallback\n    const taskIndex = tasks.findIndex(\n      (task) => task.id === currentEditingTaskId\n    );\n    if (taskIndex !== -1) {\n      tasks[taskIndex].archived = true;\n      saveTasksToLocalStorage();\n      renderTasks();\n      updateStats();\n      showNotification(\"Task archived successfully!\", \"success\");\n      closeModal(elements.taskModal);\n    }\n  }\n}\n\n// Archive all completed tasks\nfunction archiveCompletedTasks() {\n  if (confirm(\"Are you sure you want to archive all completed tasks?\")) {\n    const completedTasks = tasks.filter(\n      (task) => task.status === \"done\" && !task.archived\n    );\n\n    if (currentUser) {\n      const batch = db.batch();\n      const tasksRef = db\n        .collection(\"users\")\n        .doc(currentUser.uid)\n        .collection(\"tasks\");\n\n      completedTasks.forEach((task) => {\n        const taskRef = tasksRef.doc(task.id);\n        batch.update(taskRef, {\n          archived: true,\n          updatedAt: firebase.firestore.FieldValue.serverTimestamp(),\n        });\n      });\n\n      batch\n        .commit()\n        .then(() => {\n          console.log(\"All completed tasks archived successfully\");\n          showNotification(\n            \"All completed tasks archived successfully!\",\n            \"success\"\n          );\n        })\n        .catch((error) => {\n          console.error(\"Error archiving completed tasks: \", error);\n          showNotification(\"Error archiving completed tasks\", \"error\");\n        });\n    } else {\n      // Local storage fallback\n      tasks.forEach((task) => {\n        if (task.status === \"done\" && !task.archived) {\n          task.archived = true;\n        }\n      });\n      saveTasksToLocalStorage();\n      renderTasks();\n      updateStats();\n      showNotification(\"All completed tasks archived successfully!\", \"success\");\n    }\n  }\n}\n\n// Clear all completed tasks\nfunction clearCompletedTasks() {\n  if (\n    confirm(\n      \"Are you sure you want to permanently delete all completed tasks? This action cannot be undone.\"\n    )\n  ) {\n    const completedTasks = tasks.filter((task) => task.status === \"done\");\n\n    if (currentUser) {\n      const batch = db.batch();\n      const tasksRef = db\n        .collection(\"users\")\n        .doc(currentUser.uid)\n        .collection(\"tasks\");\n\n      completedTasks.forEach((task) => {\n        const taskRef = tasksRef.doc(task.id);\n        batch.delete(taskRef);\n      });\n\n      batch\n        .commit()\n        .then(() => {\n          console.log(\"All completed tasks deleted successfully\");\n          showNotification(\n            \"All completed tasks deleted successfully!\",\n            \"success\"\n          );\n        })\n        .catch((error) => {\n          console.error(\"Error deleting completed tasks: \", error);\n          showNotification(\"Error deleting completed tasks\", \"error\");\n        });\n    } else {\n      // Local storage fallback\n      tasks = tasks.filter((task) => task.status !== \"done\");\n      saveTasksToLocalStorage();\n      renderTasks();\n      updateStats();\n      showNotification(\"All completed tasks deleted successfully!\", \"success\");\n    }\n  }\n}\n\n// Show archived tasks\nfunction showArchivedTasks() {\n  const archivedTasks = tasks.filter((task) => task.archived);\n\n  // Clear the list\n  elements.archivedTasksList.innerHTML = \"\";\n\n  if (archivedTasks.length === 0) {\n    elements.archivedTasksList.innerHTML = `\n      <div class=\"empty-state\">\n        <i class=\"fas fa-archive\"></i>\n        <p>No archived tasks found</p>\n      </div>\n    `;\n  } else {\n    archivedTasks.forEach((task) => {\n      const taskElement = createArchivedTaskElement(task);\n      elements.archivedTasksList.appendChild(taskElement);\n    });\n  }\n\n  openModal(elements.archiveModal);\n}\n\n// Restore archived task\nfunction restoreTask(taskId) {\n  if (currentUser) {\n    db.collection(\"users\")\n      .doc(currentUser.uid)\n      .collection(\"tasks\")\n      .doc(taskId)\n      .update({\n        archived: false,\n        updatedAt: firebase.firestore.FieldValue.serverTimestamp(),\n      })\n      .then(() => {\n        console.log(\"Task restored successfully\");\n        showNotification(\"Task restored successfully!\", \"success\");\n      })\n      .catch((error) => {\n        console.error(\"Error restoring task: \", error);\n        showNotification(\"Error restoring task\", \"error\");\n      });\n  } else {\n    // Local storage fallback\n    const taskIndex = tasks.findIndex((task) => task.id === taskId);\n    if (taskIndex !== -1) {\n      tasks[taskIndex].archived = false;\n      saveTasksToLocalStorage();\n      renderTasks();\n      updateStats();\n      showNotification(\"Task restored successfully!\", \"success\");\n    }\n  }\n}\n\n// Filter tasks based on current filter and search query\nfunction filterTasks(filter) {\n  currentFilter = filter;\n  filterAndRenderTasks();\n}\n\n// Filter and render tasks based on current filters\nfunction filterAndRenderTasks() {\n  let filteredTasks = [...tasks];\n\n  // Apply status filter\n  if (currentFilter !== \"all\") {\n    filteredTasks = filteredTasks.filter((task) => {\n      if (currentFilter === \"active\") {\n        return task.status !== \"done\" && !task.archived;\n      } else if (currentFilter === \"completed\") {\n        return task.status === \"done\" && !task.archived;\n      }\n      return !task.archived;\n    });\n  } else {\n    filteredTasks = filteredTasks.filter((task) => !task.archived);\n  }\n\n  // Apply tag filter\n  if (currentTagFilter !== \"all\") {\n    filteredTasks = filteredTasks.filter(\n      (task) => task.tags && task.tags.includes(currentTagFilter)\n    );\n  }\n\n  // Apply search query\n  if (searchQuery) {\n    filteredTasks = filteredTasks.filter(\n      (task) =>\n        task.title.toLowerCase().includes(searchQuery) ||\n        task.description.toLowerCase().includes(searchQuery) ||\n        (task.tags &&\n          task.tags.some((tag) => tag.toLowerCase().includes(searchQuery)))\n    );\n  }\n\n  // Apply sorting\n  filteredTasks.sort((a, b) => {\n    switch (currentSort) {\n      case \"date-added-asc\":\n        return new Date(a.createdAt) - new Date(b.createdAt);\n      case \"date-added-desc\":\n        return new Date(b.createdAt) - new Date(a.createdAt);\n      case \"importance-asc\":\n        return a.importance - b.importance;\n      case \"importance-desc\":\n        return b.importance - a.importance;\n      case \"progress-asc\":\n        return a.progress - b.progress;\n      case \"progress-desc\":\n        return b.progress - a.progress;\n      case \"due-date-asc\":\n        return new Date(a.dueDate) - new Date(b.dueDate);\n      case \"due-date-desc\":\n        return new Date(b.dueDate) - new Date(a.dueDate);\n      default:\n        return 0;\n    }\n  });\n\n  renderTasks(filteredTasks);\n}\n\n// Render tasks to the DOM\nfunction renderTasks(tasksToRender = tasks) {\n  console.log(\"Rendering tasks...\");\n\n  // Clear all lists\n  elements.todoList.innerHTML = \"\";\n  elements.inProgressList.innerHTML = \"\";\n  elements.doneList.innerHTML = \"\";\n\n  // Filter out archived tasks\n  const activeTasks = tasksToRender.filter((task) => !task.archived);\n\n  if (activeTasks.length === 0) {\n    // Show empty state in all columns\n    elements.todoList.innerHTML = `\n      <div class=\"empty-state\">\n        <i class=\"fas fa-clipboard-list\"></i>\n        <p>No tasks to do. Add a new task!</p>\n      </div>\n    `;\n\n    elements.inProgressList.innerHTML = `\n      <div class=\"empty-state\">\n        <i class=\"fas fa-spinner\"></i>\n        <p>No tasks in progress</p>\n      </div>\n    `;\n\n    elements.doneList.innerHTML = `\n      <div class=\"empty-state\">\n        <i class=\"fas fa-check-circle\"></i>\n        <p>No tasks completed yet</p>\n      </div>\n    `;\n\n    return;\n  }\n\n  // Group tasks by status\n  const todoTasks = activeTasks.filter((task) => task.status === \"todo\");\n  const inProgressTasks = activeTasks.filter(\n    (task) => task.status === \"in-progress\"\n  );\n  const doneTasks = activeTasks.filter((task) => task.status === \"done\");\n\n  // Render todo tasks\n  if (todoTasks.length === 0) {\n    elements.todoList.innerHTML = `\n      <div class=\"empty-state\">\n        <i class=\"fas fa-clipboard-list\"></i>\n        <p>No tasks to do</p>\n      </div>\n    `;\n  } else {\n    todoTasks.forEach((task) => {\n      const taskElement = createTaskElement(task);\n      elements.todoList.appendChild(taskElement);\n    });\n  }\n\n  // Render in progress tasks\n  if (inProgressTasks.length === 0) {\n    elements.inProgressList.innerHTML = `\n      <div class=\"empty-state\">\n        <i class=\"fas fa-spinner\"></i>\n        <p>No tasks in progress</p>\n      </div>\n    `;\n  } else {\n    inProgressTasks.forEach((task) => {\n      const taskElement = createTaskElement(task);\n      elements.inProgressList.appendChild(taskElement);\n    });\n  }\n\n  // Render done tasks\n  if (doneTasks.length === 0) {\n    elements.doneList.innerHTML = `\n      <div class=\"empty-state\">\n        <i class=\"fas fa-check-circle\"></i>\n        <p>No tasks completed yet</p>\n      </div>\n    `;\n  } else {\n    doneTasks.forEach((task) => {\n      const taskElement = createTaskElement(task);\n      elements.doneList.appendChild(taskElement);\n    });\n  }\n}\n\n// Create a task element for the DOM\nfunction createTaskElement(task) {\n  const taskElement = document.createElement(\"div\");\n  taskElement.className = \"task-card\";\n  taskElement.draggable = true;\n  taskElement.dataset.id = task.id;\n\n  // Add priority border\n  if (task.importance === 3) {\n    taskElement.classList.add(\"task-card-priority-high\");\n  } else if (task.importance === 2) {\n    taskElement.classList.add(\"task-card-priority-medium\");\n  } else {\n    taskElement.classList.add(\"task-card-priority-low\");\n  }\n\n  // Check if overdue\n  const isOverdue =\n    task.dueDate &&\n    new Date(task.dueDate) < new Date() &&\n    task.status !== \"done\";\n\n  // Format due date\n  const dueDate = task.dueDate\n    ? new Date(task.dueDate).toLocaleDateString()\n    : \"No due date\";\n\n  // Create checkpoints HTML if any\n  let checkpointsHTML = \"\";\n  if (task.checkpoints && task.checkpoints.length > 0) {\n    const completedCount = task.checkpoints.filter((cp) => cp.completed).length;\n    checkpointsHTML = `\n      <div class=\"task-progress\">\n        <div class=\"progress-bar\">\n          <div class=\"progress-fill\" style=\"width: ${task.progress}%\"></div>\n        </div>\n        <div class=\"progress-text\">${completedCount}/${task.checkpoints.length} checkpoints completed</div>\n      </div>\n    `;\n  }\n\n  // Create tags HTML if any\n  let tagsHTML = \"\";\n  if (task.tags && task.tags.length > 0) {\n    tagsHTML = `\n      <div class=\"task-tags\">\n        ${task.tags\n          .map((tag) => {\n            const tagColor = getTagColor(tag);\n            return `<span class=\"task-tag\" style=\"background-color: ${tagColor}\">${tag}</span>`;\n          })\n          .join(\"\")}\n      </div>\n    `;\n  }\n\n  taskElement.innerHTML = `\n    <div class=\"task-header\">\n      <h3 class=\"task-title\">${task.title}</h3>\n      <span class=\"task-difficulty ${task.difficulty}\">${task.difficulty}</span>\n    </div>\n    <p class=\"task-description\">${task.description || \"No description\"}</p>\n    ${checkpointsHTML}\n    ${tagsHTML}\n    <div class=\"task-meta\">\n      <span class=\"task-date\"><i class=\"fas fa-calendar\"></i> ${dueDate}</span>\n      <div class=\"task-importance\" data-importance=\"${task.importance}\">${\n    task.importance\n  }</div>\n    </div>\n    ${\n      isOverdue\n        ? '<div class=\"task-overdue-badge\"><i class=\"fas fa-clock\"></i> Overdue</div>'\n        : \"\"\n    }\n    <div class=\"task-actions\">\n      <button class=\"btn-info btn-sm edit-task\" data-id=\"${task.id}\">\n        <i class=\"fas fa-edit\"></i>\n      </button>\n      <button class=\"btn-success btn-sm complete-task\" data-id=\"${task.id}\">\n        <i class=\"fas fa-check\"></i>\n      </button>\n    </div>\n  `;\n\n  // Add event listeners to buttons\n  taskElement\n    .querySelector(\".edit-task\")\n    .addEventListener(\"click\", () => editTaskById(task.id));\n  taskElement\n    .querySelector(\".complete-task\")\n    .addEventListener(\"click\", () => completeTask(task.id));\n\n  // Add drag event listeners\n  taskElement.addEventListener(\"dragstart\", handleDragStart);\n  taskElement.addEventListener(\"dragend\", handleDragEnd);\n\n  return taskElement;\n}\n\n// Helper function for editing task by ID\nfunction editTaskById(taskId) {\n  const task = tasks.find((t) => t.id === taskId);\n  if (task) {\n    currentEditingTaskId = taskId;\n    openTaskModal(taskId);\n  }\n}\n\n// Create an archived task element for the DOM\nfunction createArchivedTaskElement(task) {\n  const taskElement = document.createElement(\"div\");\n  taskElement.className = \"task-card\";\n  taskElement.dataset.id = task.id;\n\n  // Format due date\n  const dueDate = task.dueDate\n    ? new Date(task.dueDate).toLocaleDateString()\n    : \"No due date\";\n\n  taskElement.innerHTML = `\n    <div class=\"task-header\">\n      <h3 class=\"task-title\">${task.title}</h3>\n      <span class=\"task-difficulty ${task.difficulty}\">${task.difficulty}</span>\n    </div>\n    <p class=\"task-description\">${task.description || \"No description\"}</p>\n    <div class=\"task-meta\">\n      <span class=\"task-date\">Due: ${dueDate}</span>\n      <span class=\"task-importance\" data-importance=\"${task.importance}\">${\n    task.importance\n  }</span>\n    </div>\n    <div class=\"task-actions\">\n      <button class=\"btn-info restore-task\" data-id=\"${task.id}\">\n        <i class=\"fas fa-undo\"></i>Restore\n      </button>\n    </div>\n  `;\n\n  // Add event listener to restore button\n  taskElement\n    .querySelector(\".restore-task\")\n    .addEventListener(\"click\", () => restoreTask(task.id));\n\n  return taskElement;\n}\n\n// Edit task\nfunction editTask(taskId) {\n  console.log(\"Editing task:\", taskId);\n\n  const task = tasks.find((t) => t.id === taskId);\n  if (!task) return;\n\n  currentEditingTaskId = taskId;\n\n  // Fill the modal form with task data\n  elements.modalTaskTitle.value = task.title;\n  elements.modalTaskDescription.value = task.description || \"\";\n  elements.modalTaskDueDate.value = task.dueDate || \"\";\n  elements.modalTaskStartTime.value = task.startTime || \"\";\n  elements.modalTaskEndTime.value = task.endTime || \"\";\n  elements.modalTaskRecurrence.value = task.recurrence || \"none\";\n  elements.modalTaskDifficulty.value = task.difficulty || \"medium\";\n  elements.modalTaskReminder.value = task.reminder || \"none\";\n\n  // Set importance\n  document\n    .querySelectorAll(\".modal-actions .importance-option\")\n    .forEach((option) => {\n      option.classList.remove(\"selected\");\n      if (parseInt(option.dataset.importance) === task.importance) {\n        option.classList.add(\"selected\");\n      }\n    });\n\n  // Set tags\n  for (let option of elements.modalTaskTags.options) {\n    option.selected = task.tags && task.tags.includes(option.value);\n  }\n\n  // Create checkpoints container\n  elements.modalCheckpoints.innerHTML = `\n      <div class=\"checkpoints-container\" id=\"modal-checkpoints-container\"></div>\n      <div class=\"add-checkpoint-form\">\n          <input type=\"text\" id=\"new-checkpoint-input\" placeholder=\"Add a new checkpoint\">\n          <button class=\"add-checkpoint-btn\" id=\"add-checkpoint-btn\">\n              <i class=\"fas fa-plus\"></i> Add\n          </button>\n      </div>\n  `;\n\n  const checkpointsContainer = document.getElementById(\n    \"modal-checkpoints-container\"\n  );\n\n  // Add existing checkpoints\n  if (task.checkpoints && task.checkpoints.length > 0) {\n    task.checkpoints.forEach((checkpoint, index) => {\n      const checkpointElement = document.createElement(\"div\");\n      checkpointElement.className = `checkpoint-item ${\n        checkpoint.completed ? \"completed\" : \"\"\n      }`;\n      checkpointElement.innerHTML = `\n              <input type=\"checkbox\" id=\"checkpoint-${index}\" ${\n        checkpoint.completed ? \"checked\" : \"\"\n      }>\n              <label for=\"checkpoint-${index}\" class=\"checkpoint-text\">${\n        checkpoint.text\n      }</label>\n          `;\n\n      // Add event listener to update task when checkbox is toggled\n      const checkbox = checkpointElement.querySelector(\n        'input[type=\"checkbox\"]'\n      );\n      checkbox.addEventListener(\"change\", () => {\n        updateCheckpointStatus(taskId, index, checkbox.checked);\n        checkpointElement.classList.toggle(\"completed\", checkbox.checked);\n      });\n\n      checkpointsContainer.appendChild(checkpointElement);\n    });\n  } else {\n    checkpointsContainer.innerHTML =\n      '<p class=\"text-center\">No checkpoints added yet</p>';\n  }\n\n  // Add event listener for adding new checkpoints\n  document\n    .getElementById(\"add-checkpoint-btn\")\n    .addEventListener(\"click\", addNewCheckpoint);\n  document\n    .getElementById(\"new-checkpoint-input\")\n    .addEventListener(\"keypress\", (e) => {\n      if (e.key === \"Enter\") {\n        addNewCheckpoint();\n      }\n    });\n\n  openModal(elements.taskModal);\n}\n\n// Add new checkpoint to task\nfunction addNewCheckpoint() {\n  const input = document.getElementById(\"new-checkpoint-input\");\n  const text = input.value.trim();\n\n  if (!text) return;\n\n  const taskId = currentEditingTaskId;\n  const task = tasks.find((t) => t.id === taskId);\n  if (!task) return;\n\n  // Create new checkpoint\n  const newCheckpoint = {\n    text: text,\n    completed: false,\n  };\n\n  // Update task with new checkpoint\n  if (!task.checkpoints) {\n    task.checkpoints = [];\n  }\n\n  task.checkpoints.push(newCheckpoint);\n\n  // Update in Firestore if user is logged in, otherwise in local storage\n  if (currentUser) {\n    db.collection(\"users\")\n      .doc(currentUser.uid)\n      .collection(\"tasks\")\n      .doc(taskId)\n      .update({\n        checkpoints: task.checkpoints,\n        updatedAt: firebase.firestore.FieldValue.serverTimestamp(),\n      })\n      .then(() => {\n        console.log(\"Checkpoint added successfully\");\n        // Refresh the checkpoints display\n        editTask(taskId);\n        input.value = \"\";\n      })\n      .catch((error) => {\n        console.error(\"Error adding checkpoint: \", error);\n        showNotification(\"Error adding checkpoint\", \"error\");\n      });\n  } else {\n    // Local storage fallback\n    saveTasksToLocalStorage();\n    // Refresh the checkpoints display\n    editTask(taskId);\n    input.value = \"\";\n    showNotification(\"Checkpoint added successfully!\", \"success\");\n  }\n}\n\n// Complete task\nfunction completeTask(taskId) {\n  const task = tasks.find((t) => t.id === taskId);\n  if (!task) return;\n\n  if (task.status === \"done\") {\n    // If already done, mark as todo\n    updateTaskStatus(taskId, \"todo\");\n    showNotification(\"Task marked as todo\", \"info\");\n  } else {\n    // Mark as done\n    updateTaskStatus(taskId, \"done\");\n    showNotification(\"Task completed!\", \"success\");\n  }\n}\n\n// Update task status\nfunction updateTaskStatus(taskId, status) {\n  if (currentUser) {\n    db.collection(\"users\")\n      .doc(currentUser.uid)\n      .collection(\"tasks\")\n      .doc(taskId)\n      .update({\n        status: status,\n        updatedAt: firebase.firestore.FieldValue.serverTimestamp(),\n      })\n      .then(() => {\n        console.log(\"Task status updated successfully\");\n      })\n      .catch((error) => {\n        console.error(\"Error updating task status: \", error);\n        showNotification(\"Error updating task status\", \"error\");\n      });\n  } else {\n    // Local storage fallback\n    const taskIndex = tasks.findIndex((task) => task.id === taskId);\n    if (taskIndex !== -1) {\n      tasks[taskIndex].status = status;\n      saveTasksToLocalStorage();\n      renderTasks();\n      updateStats();\n    }\n  }\n}\n\n// Set up drag and drop functionality\nfunction setupDragAndDrop() {\n  const taskLists = document.querySelectorAll(\".task-list\");\n\n  taskLists.forEach((list) => {\n    list.addEventListener(\"dragover\", handleDragOver);\n    list.addEventListener(\"dragenter\", handleDragEnter);\n    list.addEventListener(\"dragleave\", handleDragLeave);\n    list.addEventListener(\"drop\", handleDrop);\n  });\n}\n\n// Handle drag start\nfunction handleDragStart(e) {\n  e.dataTransfer.setData(\"text/plain\", e.target.dataset.id);\n  e.target.classList.add(\"dragging\");\n}\n\n// Handle drag end\nfunction handleDragEnd(e) {\n  e.target.classList.remove(\"dragging\");\n}\n\n// Handle drag over\nfunction handleDragOver(e) {\n  e.preventDefault();\n}\n\n// Handle drag enter\nfunction handleDragEnter(e) {\n  e.preventDefault();\n  e.target.classList.add(\"drag-over\");\n}\n\n// Handle drag leave\nfunction handleDragLeave(e) {\n  e.target.classList.remove(\"drag-over\");\n}\n\n// Handle drop\nfunction handleDrop(e) {\n  e.preventDefault();\n  e.target.classList.remove(\"drag-over\");\n\n  const taskId = e.dataTransfer.getData(\"text/plain\");\n  const newStatus = e.target.closest(\".category\").dataset.status;\n\n  updateTaskStatus(taskId, newStatus);\n}\n\n// Reset form\nfunction resetForm() {\n  elements.taskTitle.value = \"\";\n  elements.taskDescription.value = \"\";\n  elements.taskDueDate.value = new Date().toISOString().split(\"T\")[0];\n  elements.taskStartTime.value = \"\";\n  elements.taskEndTime.value = \"\";\n  elements.taskRecurrence.value = \"none\";\n  elements.taskDifficulty.value = \"medium\";\n  elements.taskCheckpoints.value = \"\";\n  elements.taskReminder.value = \"none\";\n\n  // Reset importance selection\n  document.querySelectorAll(\".importance-option\").forEach((option) => {\n    option.classList.remove(\"selected\");\n  });\n  document\n    .querySelector('.importance-option[data-importance=\"1\"]')\n    .classList.add(\"selected\");\n\n  // Reset tags selection\n  clearFormTags();\n\n  elements.saveTaskBtn.disabled = true;\n  currentEditingTaskId = null;\n}\n\nfunction validatePasswordRequirements(password, confirmPassword = \"\") {\n  const requirements = {\n    length: password.length >= 8,\n    upper: /[A-Z]/.test(password),\n    lower: /[a-z]/.test(password),\n    number: /[0-9]/.test(password),\n    special: /[!@#$%^&*(),.?\":{}|<>]/.test(password),\n    match: password === confirmPassword && password !== \"\",\n  };\n\n  // Update UI for each requirement\n  document\n    .getElementById(\"req-length\")\n    .classList.toggle(\"met\", requirements.length);\n  document\n    .getElementById(\"req-upper\")\n    .classList.toggle(\"met\", requirements.upper);\n  document\n    .getElementById(\"req-lower\")\n    .classList.toggle(\"met\", requirements.lower);\n  document\n    .getElementById(\"req-number\")\n    .classList.toggle(\"met\", requirements.number);\n  document\n    .getElementById(\"req-special\")\n    .classList.toggle(\"met\", requirements.special);\n  document\n    .getElementById(\"req-match\")\n    .classList.toggle(\"met\", requirements.match);\n\n  return requirements;\n}\n\n// Add this function to check if all requirements are met\nfunction allRequirementsMet(requirements) {\n  return (\n    requirements.length &&\n    requirements.upper &&\n    requirements.lower &&\n    requirements.number &&\n    requirements.special &&\n    requirements.match\n  );\n}\n\n// Add event listeners for password input validation\ndocument.addEventListener(\"DOMContentLoaded\", function () {\n  const signupPassword = document.getElementById(\"signup-password\");\n  const signupConfirmPassword = document.getElementById(\n    \"signup-confirm-password\"\n  );\n\n  if (signupPassword) {\n    signupPassword.addEventListener(\"input\", function () {\n      validatePasswordRequirements(this.value, signupConfirmPassword.value);\n    });\n  }\n\n  if (signupConfirmPassword) {\n    signupConfirmPassword.addEventListener(\"input\", function () {\n      validatePasswordRequirements(signupPassword.value, this.value);\n    });\n  }\n});\n\n// Update the registerUser function to use the validation\nfunction registerUser() {\n  const username = elements.signupUsername.value;\n  const email = elements.signupEmail.value;\n  const password = elements.signupPassword.value;\n  const confirmPassword = elements.signupConfirmPassword.value;\n\n  if (!username || !email || !password || !confirmPassword) {\n    showNotification(\"Please fill all fields\", \"error\");\n    return;\n  }\n\n  // Validate password requirements\n  const requirements = validatePasswordRequirements(password, confirmPassword);\n  if (!allRequirementsMet(requirements)) {\n    showNotification(\"Please meet all password requirements\", \"error\");\n    return;\n  }\n\n  // Rest of the registration code remains the same...\n  elements.registerStatus.textContent = \"Creating account...\";\n  elements.registerStatus.style.display = \"block\";\n  elements.registerStatus.style.color = \"var(--info)\";\n\n  auth\n    .createUserWithEmailAndPassword(email, password)\n    .then((userCredential) => {\n      // Signed up\n      const user = userCredential.user;\n\n      // Update profile with username\n      return user.updateProfile({\n        displayName: username,\n      });\n    })\n    .then(() => {\n      elements.registerStatus.textContent = \"Account created successfully!\";\n      elements.registerStatus.style.color = \"var(--success)\";\n      setTimeout(() => {\n        closeModal(elements.authModal);\n      }, 1000);\n    })\n    .catch((error) => {\n      console.error(\"Registration error:\", error);\n      elements.registerStatus.textContent = error.message;\n      elements.registerStatus.style.color = \"var(--danger)\";\n    });\n}\n\n// Toggle form visibility\nfunction toggleForm() {\n  const formContent = document.getElementById(\"form-content\");\n  const isCollapsed = formContent.classList.contains(\"collapsed\");\n\n  if (isCollapsed) {\n    // Expand the form\n    formContent.classList.remove(\"collapsed\");\n    formContent.classList.add(\"expanded\");\n    formContent.style.display = \"block\";\n    elements.toggleFormBtn.innerHTML = '<i class=\"fas fa-minus\"></i>Collapse';\n\n    // Force reflow to ensure animation plays\n    void formContent.offsetWidth;\n  } else {\n    // Collapse the form\n    formContent.classList.remove(\"expanded\");\n    formContent.classList.add(\"collapsed\");\n    elements.toggleFormBtn.innerHTML = '<i class=\"fas fa-plus\"></i>Expand';\n\n    // Hide the form after animation completes\n    setTimeout(() => {\n      if (formContent.classList.contains(\"collapsed\")) {\n        formContent.style.display = \"none\";\n      }\n    }, 500); // Match the animation duration\n  }\n}\n\n// Toggle dark mode\nfunction toggleDarkMode() {\n  const isDarkMode = document.body.classList.contains(\"dark-mode\");\n\n  if (isDarkMode) {\n    document.body.classList.remove(\"dark-mode\");\n    document.body.classList.add(\"light-mode\");\n    elements.modeToggle.textContent = \"\u2600\uFE0F\";\n    localStorage.setItem(\"theme\", \"light\");\n  } else {\n    document.body.classList.remove(\"light-mode\");\n    document.body.classList.add(\"dark-mode\");\n    elements.modeToggle.textContent = \"\uD83C\uDF19\";\n    localStorage.setItem(\"theme\", \"dark\");\n  }\n}\n\n// Toggle view between kanban and calendar\nfunction toggleView() {\n  if (currentView === \"kanban\") {\n    elements.kanbanView.style.display = \"none\";\n    elements.calendarView.style.display = \"block\";\n    elements.viewToggle.innerHTML = '<i class=\"fas fa-columns\"></i>Kanban View';\n    currentView = \"calendar\";\n    generateCalendar(currentMonth, currentYear);\n  } else {\n    elements.kanbanView.style.display = \"grid\";\n    elements.calendarView.style.display = \"none\";\n    elements.viewToggle.innerHTML =\n      '<i class=\"fas fa-calendar\"></i>Calendar View';\n    currentView = \"kanban\";\n  }\n\n  localStorage.setItem(\"view\", currentView);\n}\n\n// Generate calendar\nfunction generateCalendar(month, year) {\n  console.log(\"Generating calendar for:\", month, year);\n\n  // Update calendar header\n  const monthNames = [\n    \"January\",\n    \"February\",\n    \"March\",\n    \"April\",\n    \"May\",\n    \"June\",\n    \"July\",\n    \"August\",\n    \"September\",\n    \"October\",\n    \"November\",\n    \"December\",\n  ];\n  elements.calendarMonthYear.textContent = `${monthNames[month]} ${year}`;\n\n  // Clear calendar grid\n  elements.calendarGrid.innerHTML = \"\";\n\n  // Get first day of month and number of days\n  const firstDay = new Date(year, month, 1).getDay();\n  const daysInMonth = new Date(year, month + 1, 0).getDate();\n  const prevMonthDays = new Date(year, month, 0).getDate();\n\n  // Create day headers\n  const dayNames = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\n  dayNames.forEach((day) => {\n    const dayHeader = document.createElement(\"div\");\n    dayHeader.className = \"calendar-weekday-header\";\n    dayHeader.textContent = day;\n    elements.calendarGrid.appendChild(dayHeader);\n  });\n\n  // Add cells for days from previous month\n  for (let i = firstDay - 1; i >= 0; i--) {\n    const emptyDay = document.createElement(\"div\");\n    emptyDay.className = \"calendar-day other-month\";\n    const dayNum = document.createElement(\"div\");\n    dayNum.className = \"calendar-day-number\";\n    dayNum.textContent = prevMonthDays - i;\n    emptyDay.appendChild(dayNum);\n    elements.calendarGrid.appendChild(emptyDay);\n  }\n\n  // Add cells for each day of the month\n  const today = new Date();\n  today.setHours(0, 0, 0, 0);\n\n  for (let day = 1; day <= daysInMonth; day++) {\n    const dayElement = document.createElement(\"div\");\n    dayElement.className = \"calendar-day\";\n\n    const currentDate = `${year}-${String(month + 1).padStart(2, \"0\")}-${String(\n      day\n    ).padStart(2, \"0\")}`;\n    const dayDate = new Date(year, month, day);\n    dayDate.setHours(0, 0, 0, 0);\n\n    // Check if this day is today\n    if (dayDate.getTime() === today.getTime()) {\n      dayElement.classList.add(\"today\");\n    }\n\n    // Check if weekend\n    const dayOfWeek = dayDate.getDay();\n    if (dayOfWeek === 0 || dayOfWeek === 6) {\n      dayElement.classList.add(\"weekend\");\n    }\n\n    // Add day number\n    const dayNumber = document.createElement(\"div\");\n    dayNumber.className = \"calendar-day-number\";\n    dayNumber.textContent = day;\n    dayElement.appendChild(dayNumber);\n\n    // Get tasks for this day\n    const dayTasks = tasks.filter(\n      (task) => task.dueDate === currentDate && !task.archived && !task.deleted\n    );\n\n    // Add tasks container\n    const tasksContainer = document.createElement(\"div\");\n    tasksContainer.className = \"calendar-tasks\";\n\n    if (dayTasks.length > 0) {\n      // Show up to 3 tasks, then show \"+X more\"\n      const visibleTasks = dayTasks.slice(0, 3);\n\n      visibleTasks.forEach((task) => {\n        const taskElement = document.createElement(\"div\");\n        taskElement.className = \"calendar-task\";\n\n        // Add status class\n        taskElement.classList.add(`status-${task.status}`);\n\n        // Add importance indicator\n        const importanceIndicator = document.createElement(\"span\");\n        importanceIndicator.className = \"task-importance-dot\";\n        importanceIndicator.dataset.importance = task.importance;\n\n        // Task title\n        const taskTitle = document.createElement(\"span\");\n        taskTitle.className = \"calendar-task-title\";\n        taskTitle.textContent = task.title;\n\n        // Truncate long titles\n        if (task.title.length > 20) {\n          taskTitle.textContent = task.title.substring(0, 20) + \"...\";\n          taskTitle.title = task.title; // Show full title on hover\n        }\n\n        taskElement.appendChild(importanceIndicator);\n        taskElement.appendChild(taskTitle);\n\n        // Add click handler\n        taskElement.addEventListener(\"click\", (e) => {\n          e.stopPropagation();\n          editTask(task.id);\n        });\n\n        tasksContainer.appendChild(taskElement);\n      });\n\n      // Show \"more\" indicator if there are more than 3 tasks\n      if (dayTasks.length > 3) {\n        const moreIndicator = document.createElement(\"div\");\n        moreIndicator.className = \"calendar-more-tasks\";\n        moreIndicator.textContent = `+${dayTasks.length - 3} more`;\n        moreIndicator.addEventListener(\"click\", (e) => {\n          e.stopPropagation();\n          showDayTasks(currentDate, dayTasks);\n        });\n        tasksContainer.appendChild(moreIndicator);\n      }\n    }\n\n    dayElement.appendChild(tasksContainer);\n\n    // Add click handler to day for adding new task\n    dayElement.addEventListener(\"click\", () => {\n      elements.taskDueDate.value = currentDate;\n      elements.taskTitle.focus();\n      showNotification(`Adding task for ${monthNames[month]} ${day}`, \"info\");\n    });\n\n    elements.calendarGrid.appendChild(dayElement);\n  }\n\n  // Add cells for days from next month to complete the grid\n  const totalCells = elements.calendarGrid.children.length - 7; // Subtract day headers\n  const remainingCells = 42 - totalCells - 7; // 6 rows * 7 days - headers\n\n  for (let day = 1; day <= remainingCells; day++) {\n    const nextMonthDay = document.createElement(\"div\");\n    nextMonthDay.className = \"calendar-day other-month\";\n    const dayNum = document.createElement(\"div\");\n    dayNum.className = \"calendar-day-number\";\n    dayNum.textContent = day;\n    nextMonthDay.appendChild(dayNum);\n    elements.calendarGrid.appendChild(nextMonthDay);\n  }\n}\n\n// Show all tasks for a specific day\nfunction showDayTasks(date, dayTasks) {\n  const dateObj = new Date(date);\n  const formattedDate = dateObj.toLocaleDateString(\"en-US\", {\n    weekday: \"long\",\n    year: \"numeric\",\n    month: \"long\",\n    day: \"numeric\",\n  });\n\n  const modal = document.createElement(\"div\");\n  modal.className = \"modal-overlay\";\n  modal.style.display = \"flex\";\n  modal.innerHTML = `\n    <div class=\"task-modal\">\n      <button class=\"close-modal\">\u00D7</button>\n      <h2><i class=\"fas fa-calendar-day\"></i> ${formattedDate}</h2>\n      <div class=\"day-tasks-list\">\n        ${dayTasks\n          .map(\n            (task) => `\n          <div class=\"day-task-item\" data-id=\"${task.id}\">\n            <div class=\"task-header\">\n              <span class=\"task-importance-badge\" data-importance=\"${\n                task.importance\n              }\">${task.importance}</span>\n              <h3>${task.title}</h3>\n              <span class=\"task-status-badge status-${task.status}\">${\n              task.status\n            }</span>\n            </div>\n            <p class=\"task-description\">${\n              task.description || \"No description\"\n            }</p>\n            <div class=\"task-meta\">\n              <span class=\"task-difficulty ${task.difficulty}\">${\n              task.difficulty\n            }</span>\n              ${\n                task.tags\n                  ? task.tags\n                      .map((tag) => {\n                        const tagConfig = customTags.find(\n                          (t) => t.name === tag\n                        );\n                        return `<span class=\"task-tag\" style=\"background-color: ${\n                          tagConfig ? tagConfig.color : \"#6c5ce7\"\n                        }\">${tag}</span>`;\n                      })\n                      .join(\"\")\n                  : \"\"\n              }\n            </div>\n          </div>\n        `\n          )\n          .join(\"\")}\n      </div>\n    </div>\n  `;\n\n  document.body.appendChild(modal);\n\n  // Add click handlers\n  modal.querySelector(\".close-modal\").addEventListener(\"click\", () => {\n    document.body.removeChild(modal);\n  });\n\n  modal.addEventListener(\"click\", (e) => {\n    if (e.target === modal) {\n      document.body.removeChild(modal);\n    }\n  });\n\n  // Add click handlers to task items\n  modal.querySelectorAll(\".day-task-item\").forEach((item) => {\n    item.addEventListener(\"click\", () => {\n      const taskId = item.dataset.id;\n      document.body.removeChild(modal);\n      editTask(taskId);\n    });\n  });\n}\n\n// Change calendar month\nfunction changeMonth(direction) {\n  currentMonth += direction;\n\n  if (currentMonth < 0) {\n    currentMonth = 11;\n    currentYear--;\n  } else if (currentMonth > 11) {\n    currentMonth = 0;\n    currentYear++;\n  }\n\n  generateCalendar(currentMonth, currentYear);\n}\n\n// Update statistics\nfunction updateStats() {\n  const total = tasks.filter((task) => !task.archived).length;\n  const completed = tasks.filter(\n    (task) => task.status === \"done\" && !task.archived\n  ).length;\n  const inProgress = tasks.filter(\n    (task) => task.status === \"in-progress\" && !task.archived\n  ).length;\n\n  // Calculate overdue tasks\n  const today = new Date().toISOString().split(\"T\")[0];\n  const overdue = tasks.filter(\n    (task) =>\n      task.dueDate &&\n      task.dueDate < today &&\n      task.status !== \"done\" &&\n      !task.archived\n  ).length;\n\n  // Calculate overall progress\n  const overallProgress = total > 0 ? Math.round((completed / total) * 100) : 0;\n\n  // Update DOM\n  elements.totalTasks.textContent = total;\n  elements.completedTasks.textContent = completed;\n  elements.inprogressTasks.textContent = inProgress;\n  elements.overdueTasks.textContent = overdue;\n  elements.overallProgress.textContent = `${overallProgress}%`;\n\n  // Update charts with new data (only if charts are initialized)\n  if (window.statusChart || window.completionChart || window.weeklyChart) {\n    updateCharts();\n  }\n}\n\n// Initialize charts\nfunction initCharts() {\n  console.log(\"\uD83D\uDCC8 Initializing charts...\");\n\n  // Check if Chart.js is loaded\n  if (typeof Chart === \"undefined\") {\n    console.error(\"\u274C Chart.js is not loaded!\");\n    return;\n  }\n\n  try {\n    // Completion trend chart\n    const completionCanvas = document.getElementById(\"completion-chart\");\n    if (completionCanvas) {\n      console.log(\"  \uD83D\uDD35 Initializing completion chart...\");\n      const completionCtx = completionCanvas.getContext(\"2d\");\n      window.completionChart = new Chart(completionCtx, {\n        type: \"line\",\n        data: {\n          labels: [\"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"],\n          datasets: [\n            {\n              label: \"Tasks Completed\",\n              data: [0, 0, 0, 0, 0, 0, 0],\n              borderColor: \"#6c5ce7\",\n              backgroundColor: \"rgba(108, 92, 231, 0.2)\",\n              tension: 0.4,\n              fill: true,\n              borderWidth: 3,\n              pointRadius: 5,\n              pointHoverRadius: 7,\n              pointBackgroundColor: \"#6c5ce7\",\n              pointBorderColor: \"#fff\",\n              pointBorderWidth: 2,\n            },\n          ],\n        },\n        options: {\n          responsive: true,\n          maintainAspectRatio: true,\n          plugins: {\n            title: {\n              display: true,\n              text: \"Weekly Completion Trend\",\n              font: {\n                size: 16,\n                weight: \"bold\",\n              },\n              color: \"#6c5ce7\",\n            },\n            legend: {\n              display: true,\n              position: \"top\",\n            },\n          },\n          scales: {\n            y: {\n              beginAtZero: true,\n              ticks: {\n                stepSize: 1,\n              },\n            },\n          },\n        },\n      });\n    }\n\n    // Status chart\n    const statusCanvas = document.getElementById(\"status-chart\");\n    if (statusCanvas) {\n      console.log(\"  \uD83D\uDFE3 Initializing status chart...\");\n      const statusCtx = statusCanvas.getContext(\"2d\");\n      window.statusChart = new Chart(statusCtx, {\n        type: \"doughnut\",\n        data: {\n          labels: [\"To Do\", \"In Progress\", \"Completed\"],\n          datasets: [\n            {\n              data: [0, 0, 0],\n              backgroundColor: [\"#74b9ff\", \"#fdcb6e\", \"#00b894\"],\n              borderWidth: 2,\n              borderColor: \"#fff\",\n            },\n          ],\n        },\n        options: {\n          responsive: true,\n          maintainAspectRatio: true,\n          plugins: {\n            legend: {\n              position: \"bottom\",\n              labels: {\n                padding: 15,\n                font: {\n                  size: 12,\n                },\n              },\n            },\n            title: {\n              display: true,\n              text: \"Tasks by Status\",\n              font: {\n                size: 16,\n                weight: \"bold\",\n              },\n              color: \"#6c5ce7\",\n            },\n          },\n        },\n      });\n    }\n\n    // Weekly productivity chart\n    const weeklyCanvas = document.getElementById(\"weekly-chart\");\n    if (weeklyCanvas) {\n      console.log(\"  \uD83D\uDFE2 Initializing weekly chart...\");\n      const weeklyCtx = weeklyCanvas.getContext(\"2d\");\n      window.weeklyChart = new Chart(weeklyCtx, {\n        type: \"bar\",\n        data: {\n          labels: [\"Week 1\", \"Week 2\", \"Week 3\", \"Week 4\"],\n          datasets: [\n            {\n              label: \"Tasks Completed\",\n              data: [0, 0, 0, 0],\n              backgroundColor: \"#6c5ce7\",\n              borderColor: \"#5649c9\",\n              borderWidth: 2,\n              borderRadius: 8,\n            },\n          ],\n        },\n        options: {\n          responsive: true,\n          maintainAspectRatio: true,\n          plugins: {\n            title: {\n              display: true,\n              text: \"Monthly Productivity\",\n              font: {\n                size: 16,\n                weight: \"bold\",\n              },\n              color: \"#6c5ce7\",\n            },\n            legend: {\n              display: true,\n              position: \"top\",\n            },\n          },\n          scales: {\n            y: {\n              beginAtZero: true,\n              ticks: {\n                stepSize: 1,\n              },\n            },\n          },\n        },\n      });\n    }\n\n    console.log(\"\u2705 Charts initialized successfully\");\n\n    // Show charts section\n    const chartsSection = document.getElementById(\"charts-section\");\n    if (chartsSection) {\n      chartsSection.style.display = \"block\";\n      console.log(\"  \u2713 Charts section made visible\");\n    }\n\n    // Update charts with initial data\n    setTimeout(() => {\n      console.log(\"\u23F1\uFE0F Updating charts with initial data...\");\n      updateCharts();\n    }, 100);\n  } catch (error) {\n    console.error(\"\u274C Error initializing charts:\", error);\n  }\n}\n\nfunction updateCheckpointStatus(taskId, checkpointIndex, completed) {\n  const task = tasks.find((t) => t.id === taskId);\n  if (!task || !task.checkpoints || !task.checkpoints[checkpointIndex]) return;\n\n  // Update checkpoint status\n  task.checkpoints[checkpointIndex].completed = completed;\n\n  // Calculate new progress\n  const totalCheckpoints = task.checkpoints.length;\n  const completedCheckpoints = task.checkpoints.filter(\n    (cp) => cp.completed\n  ).length;\n  const progress =\n    totalCheckpoints > 0\n      ? Math.round((completedCheckpoints / totalCheckpoints) * 100)\n      : 0;\n\n  // Determine new status based on checkpoint completion\n  let newStatus = task.status;\n  if (completedCheckpoints === totalCheckpoints && totalCheckpoints > 0) {\n    newStatus = \"done\"; // All checkpoints completed\n  } else if (\n    completedCheckpoints > 0 &&\n    completedCheckpoints < totalCheckpoints\n  ) {\n    newStatus = \"in-progress\"; // Some checkpoints completed\n  } else if (completedCheckpoints === 0) {\n    newStatus = \"todo\"; // No checkpoints completed\n  }\n\n  // Update in Firestore if user is logged in, otherwise in local storage\n  if (currentUser) {\n    db.collection(\"users\")\n      .doc(currentUser.uid)\n      .collection(\"tasks\")\n      .doc(taskId)\n      .update({\n        checkpoints: task.checkpoints,\n        progress: progress,\n        status: newStatus,\n        updatedAt: firebase.firestore.FieldValue.serverTimestamp(),\n      })\n      .then(() => {\n        console.log(\"Checkpoint status updated successfully\");\n        updateStats();\n\n        // Show animation for status change\n        if (newStatus !== task.status) {\n          const statusNames = {\n            todo: \"To Do\",\n            \"in-progress\": \"In Progress\",\n            done: \"Done\",\n          };\n          showNotification(\n            `Task moved to ${statusNames[newStatus]}!`,\n            \"success\"\n          );\n        }\n      })\n      .catch((error) => {\n        console.error(\"Error updating checkpoint status: \", error);\n        showNotification(\"Error updating checkpoint\", \"error\");\n      });\n  } else {\n    // Local storage fallback\n    task.progress = progress;\n    task.status = newStatus;\n    saveTasksToLocalStorage();\n    renderTasks();\n    updateStats();\n\n    // Show animation for status change\n    if (newStatus !== task.status) {\n      const statusNames = {\n        todo: \"To Do\",\n        \"in-progress\": \"In Progress\",\n        done: \"Done\",\n      };\n      showNotification(`Task moved to ${statusNames[newStatus]}!`, \"success\");\n    } else {\n      showNotification(\"Checkpoint updated!\", \"success\");\n    }\n  }\n}\n\n// Update charts with current data\nfunction updateCharts() {\n  try {\n    console.log(\"\uD83D\uDCCA Updating charts with task data...\");\n\n    // Update status chart with real data\n    if (window.statusChart) {\n      const todoCount = tasks.filter(\n        (task) => task.status === \"todo\" && !task.archived && !task.deleted\n      ).length;\n      const inProgressCount = tasks.filter(\n        (task) =>\n          task.status === \"in-progress\" && !task.archived && !task.deleted\n      ).length;\n      const doneCount = tasks.filter(\n        (task) => task.status === \"done\" && !task.archived && !task.deleted\n      ).length;\n\n      console.log(\n        \"  \u2713 Status chart - To-Do:\",\n        todoCount,\n        \"In Progress:\",\n        inProgressCount,\n        \"Done:\",\n        doneCount\n      );\n\n      window.statusChart.data.datasets[0].data = [\n        todoCount,\n        inProgressCount,\n        doneCount,\n      ];\n      window.statusChart.update();\n    } else {\n      console.warn(\"  \u26A0 Status chart not yet initialized\");\n    }\n\n    // Update completion trend - last 7 days\n    if (window.completionChart) {\n      const completionData = getWeeklyCompletionData();\n      console.log(\"  \u2713 Completion chart - Weekly data:\", completionData);\n      window.completionChart.data.datasets[0].data = completionData;\n      window.completionChart.update();\n    } else {\n      console.warn(\"  \u26A0 Completion chart not yet initialized\");\n    }\n\n    // Update weekly productivity - last 4 weeks\n    if (window.weeklyChart) {\n      const weeklyData = getMonthlyProductivityData();\n      console.log(\"  \u2713 Weekly chart - Monthly data:\", weeklyData);\n      window.weeklyChart.data.datasets[0].data = weeklyData;\n      window.weeklyChart.update();\n    } else {\n      console.warn(\"  \u26A0 Weekly chart not yet initialized\");\n    }\n\n    console.log(\"\u2705 Charts updated successfully\");\n  } catch (error) {\n    console.error(\"\u274C Error updating charts:\", error);\n  }\n}\n\n// Get weekly completion data (last 7 days)\nfunction getWeeklyCompletionData() {\n  const today = new Date();\n  today.setHours(0, 0, 0, 0);\n  const weekData = [0, 0, 0, 0, 0, 0, 0];\n\n  tasks.forEach((task) => {\n    if (task.status === \"done\" && !task.archived && !task.deleted) {\n      // Use createdAt if updatedAt is not available\n      const taskDate = task.updatedAt\n        ? task.updatedAt.toDate\n          ? task.updatedAt.toDate()\n          : new Date(task.updatedAt)\n        : task.createdAt\n        ? task.createdAt.toDate\n          ? task.createdAt.toDate()\n          : new Date(task.createdAt)\n        : new Date();\n\n      const daysDiff = Math.floor((today - taskDate) / (1000 * 60 * 60 * 24));\n\n      if (daysDiff >= 0 && daysDiff < 7) {\n        weekData[6 - daysDiff]++;\n      }\n    }\n  });\n\n  return weekData;\n}\n\n// Get monthly productivity data (last 4 weeks)\nfunction getMonthlyProductivityData() {\n  const today = new Date();\n  today.setHours(0, 0, 0, 0);\n  const monthData = [0, 0, 0, 0];\n\n  tasks.forEach((task) => {\n    if (task.status === \"done\" && !task.archived && !task.deleted) {\n      // Use createdAt if updatedAt is not available\n      const taskDate = task.updatedAt\n        ? task.updatedAt.toDate\n          ? task.updatedAt.toDate()\n          : new Date(task.updatedAt)\n        : task.createdAt\n        ? task.createdAt.toDate\n          ? task.createdAt.toDate()\n          : new Date(task.createdAt)\n        : new Date();\n\n      const daysDiff = Math.floor((today - taskDate) / (1000 * 60 * 60 * 24));\n\n      if (daysDiff >= 0 && daysDiff < 28) {\n        const weekIndex = Math.floor(daysDiff / 7);\n        if (weekIndex < 4) {\n          monthData[3 - weekIndex]++;\n        }\n      }\n    }\n  });\n\n  return monthData;\n}\n\n// Export tasks to JSON file\nfunction exportTasks() {\n  const dataStr = JSON.stringify(tasks, null, 2);\n  const dataUri =\n    \"data:application/json;charset=utf-8,\" + encodeURIComponent(dataStr);\n\n  const exportFileDefaultName = `schedulepro-tasks-${\n    new Date().toISOString().split(\"T\")[0]\n  }.json`;\n\n  const linkElement = document.createElement(\"a\");\n  linkElement.setAttribute(\"href\", dataUri);\n  linkElement.setAttribute(\"download\", exportFileDefaultName);\n  linkElement.click();\n\n  showNotification(\"Tasks exported successfully!\", \"success\");\n}\n\n// Import tasks from JSON file\nfunction importTasks(e) {\n  const file = e.target.files[0];\n  if (!file) return;\n\n  const reader = new FileReader();\n  reader.onload = function (e) {\n    try {\n      const importedTasks = JSON.parse(e.target.result);\n\n      if (Array.isArray(importedTasks)) {\n        if (\n          confirm(\n            `Import ${importedTasks.length} tasks? This will replace your current tasks.`\n          )\n        ) {\n          if (currentUser) {\n            // Import to Firestore\n            const batch = db.batch();\n            const tasksRef = db\n              .collection(\"users\")\n              .doc(currentUser.uid)\n              .collection(\"tasks\");\n\n            // First, delete existing tasks\n            tasks.forEach((task) => {\n              const taskRef = tasksRef.doc(task.id);\n              batch.delete(taskRef);\n            });\n\n            // Then add imported tasks\n            importedTasks.forEach((task) => {\n              const taskRef = tasksRef.doc();\n              batch.set(taskRef, {\n                ...task,\n                id: taskRef.id,\n                createdAt: firebase.firestore.FieldValue.serverTimestamp(),\n                updatedAt: firebase.firestore.FieldValue.serverTimestamp(),\n              });\n            });\n\n            batch\n              .commit()\n              .then(() => {\n                console.log(\"Tasks imported successfully\");\n                showNotification(\"Tasks imported successfully!\", \"success\");\n              })\n              .catch((error) => {\n                console.error(\"Error importing tasks: \", error);\n                showNotification(\"Error importing tasks\", \"error\");\n              });\n          } else {\n            // Local storage fallback\n            tasks = importedTasks;\n            saveTasksToLocalStorage();\n            renderTasks();\n            updateStats();\n            showNotification(\"Tasks imported successfully!\", \"success\");\n          }\n        }\n      } else {\n        throw new Error(\"Invalid file format\");\n      }\n    } catch (error) {\n      console.error(\"Error parsing imported file:\", error);\n      showNotification(\"Error importing tasks: Invalid file format\", \"error\");\n    }\n  };\n  reader.readAsText(file);\n\n  // Reset file input\n  e.target.value = \"\";\n}\n\n// Save tasks to local storage\nfunction saveTasksToLocalStorage() {\n  localStorage.setItem(\"schedulepro-tasks\", JSON.stringify(tasks));\n}\n\n// Load tasks from local storage\nfunction loadTasksFromLocalStorage() {\n  const storedTasks = localStorage.getItem(\"schedulepro-tasks\");\n  if (storedTasks) {\n    try {\n      tasks = JSON.parse(storedTasks);\n      renderTasks();\n      updateStats();\n    } catch (error) {\n      console.error(\"Error parsing tasks from local storage:\", error);\n      tasks = [];\n    }\n  }\n}\n\n// Load settings from local storage\nfunction loadSettings() {\n  // Load theme\n  const savedTheme = localStorage.getItem(\"theme\");\n  if (savedTheme) {\n    document.body.classList.remove(\"dark-mode\", \"light-mode\");\n    document.body.classList.add(savedTheme + \"-mode\");\n    // Note: modeToggle button removed, using theme selector buttons instead\n  }\n\n  // Load view\n  const savedView = localStorage.getItem(\"view\");\n  if (savedView) {\n    currentView = savedView;\n    if (savedView === \"calendar\") {\n      elements.kanbanView.style.display = \"none\";\n      elements.calendarView.style.display = \"block\";\n      elements.viewToggle.innerHTML =\n        '<i class=\"fas fa-columns\"></i>Kanban View';\n    } else {\n      elements.kanbanView.style.display = \"grid\";\n      elements.calendarView.style.display = \"none\";\n      elements.viewToggle.innerHTML =\n        '<i class=\"fas fa-calendar\"></i>Calendar View';\n    }\n  }\n\n  // Load other settings\n  const defaultTheme = localStorage.getItem(\"defaultTheme\");\n  if (defaultTheme) {\n    elements.defaultTheme.value = defaultTheme;\n    // Note: Theme is applied by the DOMContentLoaded listener in the theme system\n  }\n\n  const defaultView = localStorage.getItem(\"defaultView\");\n  if (defaultView) {\n    elements.defaultView.value = defaultView;\n  }\n\n  const reduceMotion = localStorage.getItem(\"reduceMotion\");\n  if (reduceMotion) {\n    elements.reduceMotion.checked = reduceMotion === \"true\";\n  }\n\n  const disableAnimations = localStorage.getItem(\"disableAnimations\");\n  if (disableAnimations) {\n    elements.disableAnimations.checked = disableAnimations === \"true\";\n  }\n}\n\n// Save settings to local storage\nfunction saveSettings() {\n  const selectedTheme = elements.defaultTheme.value;\n  localStorage.setItem(\"defaultTheme\", selectedTheme);\n  localStorage.setItem(\"defaultView\", elements.defaultView.value);\n  localStorage.setItem(\"reduceMotion\", elements.reduceMotion.checked);\n  localStorage.setItem(\"disableAnimations\", elements.disableAnimations.checked);\n\n  // Apply the selected theme immediately\n  applyTheme(selectedTheme);\n\n  showNotification(\"Settings saved successfully!\", \"success\");\n  closeModal(elements.settingsModal);\n}\n\n// Select importance level\nfunction selectImportance(option, options) {\n  options.forEach((opt) => opt.classList.remove(\"selected\"));\n  option.classList.add(\"selected\");\n}\n\n// Open modal\nfunction openModal(modal) {\n  if (!modal) {\n    console.error(\"Modal element not found\");\n    return;\n  }\n  modal.style.display = \"flex\";\n  setTimeout(() => {\n    modal.classList.add(\"visible\");\n  }, 10);\n}\n\n// Close modal\nfunction closeModal(modal) {\n  if (!modal) {\n    console.error(\"Modal element not found\");\n    return;\n  }\n  modal.classList.remove(\"visible\");\n  setTimeout(() => {\n    modal.style.display = \"none\";\n  }, 300);\n}\n\n// Close all modals\nfunction closeAllModals() {\n  const modals = document.querySelectorAll(\".modal-overlay\");\n  modals.forEach((modal) => {\n    closeModal(modal);\n  });\n}\n\n// Show notification\nfunction showNotification(message, type = \"info\") {\n  elements.notificationMessage.textContent = message;\n\n  // Set icon based on type\n  switch (type) {\n    case \"success\":\n      elements.notificationIcon.className = \"fas fa-check-circle\";\n      elements.notification.style.borderLeft = \"4px solid var(--success)\";\n      break;\n    case \"error\":\n      elements.notificationIcon.className = \"fas fa-exclamation-circle\";\n      elements.notification.style.borderLeft = \"4px solid var(--danger)\";\n      break;\n    case \"warning\":\n      elements.notificationIcon.className = \"fas fa-exclamation-triangle\";\n      elements.notification.style.borderLeft = \"4px solid var(--warning)\";\n      break;\n    default:\n      elements.notificationIcon.className = \"fas fa-info-circle\";\n      elements.notification.style.borderLeft = \"4px solid var(--info)\";\n  }\n\n  // Show notification\n  elements.notification.classList.add(\"show\");\n\n  // Auto hide after 5 seconds\n  setTimeout(() => {\n    elements.notification.classList.remove(\"show\");\n  }, 5000);\n}\n\n// Handle keyboard shortcuts\nfunction handleKeyboardShortcuts(e) {\n  // Ctrl + N: Add new task\n  if (e.ctrlKey && e.key === \"n\") {\n    e.preventDefault();\n    elements.taskTitle.focus();\n  }\n\n  // Ctrl + F: Focus search\n  if (e.ctrlKey && e.key === \"f\") {\n    e.preventDefault();\n    elements.searchInput.focus();\n  }\n\n  // Ctrl + ,: Open settings\n  if (e.ctrlKey && e.key === \",\") {\n    e.preventDefault();\n    // Update settings modal with current values before opening\n    elements.defaultTheme.value = currentTheme;\n    openModal(elements.settingsModal);\n  }\n\n  // Escape: Close modals\n  if (e.key === \"Escape\") {\n    closeAllModals();\n  }\n}\n\n// Switch between login and signup forms\nfunction switchAuthForm(form) {\n  if (form === \"signup\") {\n    elements.loginForm.classList.remove(\"active\");\n    elements.signupForm.classList.add(\"active\");\n    document.getElementById(\"auth-modal-title\").textContent = \"Create Account\";\n  } else {\n    elements.signupForm.classList.remove(\"active\");\n    elements.loginForm.classList.add(\"active\");\n    document.getElementById(\"auth-modal-title\").textContent = \"Login\";\n  }\n}\n\n// Login user with email and password\nfunction loginUser() {\n  const email = elements.loginEmail.value;\n  const password = elements.loginPassword.value;\n\n  if (!email || !password) {\n    showNotification(\"Please enter both email and password\", \"error\");\n    return;\n  }\n\n  elements.loginStatus.textContent = \"Logging in...\";\n  elements.loginStatus.style.display = \"block\";\n  elements.loginStatus.style.color = \"var(--info)\";\n\n  auth\n    .signInWithEmailAndPassword(email, password)\n    .then((userCredential) => {\n      // Signed in\n      elements.loginStatus.textContent = \"Login successful!\";\n      elements.loginStatus.style.color = \"var(--success)\";\n      setTimeout(() => {\n        closeModal(elements.authModal);\n      }, 1000);\n    })\n    .catch((error) => {\n      console.error(\"Login error:\", error);\n      elements.loginStatus.textContent = error.message;\n      elements.loginStatus.style.color = \"var(--danger)\";\n    });\n}\n\n// Register new user\nfunction registerUser() {\n  const username = elements.signupUsername.value;\n  const email = elements.signupEmail.value;\n  const password = elements.signupPassword.value;\n  const confirmPassword = elements.signupConfirmPassword.value;\n\n  if (!username || !email || !password || !confirmPassword) {\n    showNotification(\"Please fill all fields\", \"error\");\n    return;\n  }\n\n  if (password !== confirmPassword) {\n    showNotification(\"Passwords do not match\", \"error\");\n    return;\n  }\n\n  elements.registerStatus.textContent = \"Creating account...\";\n  elements.registerStatus.style.display = \"block\";\n  elements.registerStatus.style.color = \"var(--info)\";\n\n  auth\n    .createUserWithEmailAndPassword(email, password)\n    .then((userCredential) => {\n      // Signed up\n      const user = userCredential.user;\n\n      // Update profile with username\n      return user.updateProfile({\n        displayName: username,\n      });\n    })\n    .then(() => {\n      elements.registerStatus.textContent = \"Account created successfully!\";\n      elements.registerStatus.style.color = \"var(--success)\";\n      setTimeout(() => {\n        closeModal(elements.authModal);\n      }, 1000);\n    })\n    .catch((error) => {\n      console.error(\"Registration error:\", error);\n      elements.registerStatus.textContent = error.message;\n      elements.registerStatus.style.color = \"var(--danger)\";\n    });\n}\n\n// Sign in with Google\nfunction signInWithGoogle() {\n  const provider = new firebase.auth.GoogleAuthProvider();\n\n  auth\n    .signInWithPopup(provider)\n    .then((result) => {\n      // Signed in\n      closeModal(elements.authModal);\n    })\n    .catch((error) => {\n      console.error(\"Google sign-in error:\", error);\n      showNotification(\"Error signing in with Google\", \"error\");\n    });\n}\n\n// Update user profile\nfunction updateProfile() {\n  const displayName = elements.profileName.value;\n  const newPassword = elements.profilePassword.value;\n\n  if (!displayName) {\n    showNotification(\"Name is required\", \"error\");\n    return;\n  }\n\n  const promises = [];\n\n  // Update display name\n  promises.push(\n    currentUser.updateProfile({\n      displayName: displayName,\n    })\n  );\n\n  // Update password if provided\n  if (newPassword) {\n    promises.push(currentUser.updatePassword(newPassword));\n  }\n\n  Promise.all(promises)\n    .then(() => {\n      showNotification(\"Profile updated successfully!\", \"success\");\n      closeModal(elements.profileModal);\n    })\n    .catch((error) => {\n      console.error(\"Error updating profile:\", error);\n      showNotification(\"Error updating profile: \" + error.message, \"error\");\n    });\n}\n\n// Logout user\nfunction logoutUser() {\n  auth\n    .signOut()\n    .then(() => {\n      closeModal(elements.profileModal);\n      showNotification(\"Logged out successfully\", \"info\");\n    })\n    .catch((error) => {\n      console.error(\"Logout error:\", error);\n      showNotification(\"Error logging out\", \"error\");\n    });\n}\n\n// Initialize the app when DOM is loaded\ndocument.addEventListener(\"DOMContentLoaded\", init);\n\n// ========== NEW FEATURES IMPLEMENTATION ==========\n\n// Theme System\n// Check for defaultTheme from settings first, then fall back to appTheme\nlet currentTheme =\n  localStorage.getItem(\"defaultTheme\") ||\n  localStorage.getItem(\"appTheme\") ||\n  \"dark\";\nlet currentLayout = localStorage.getItem(\"appLayout\") || \"kanban\";\nlet currentDensity = localStorage.getItem(\"appDensity\") || \"relaxed\";\nlet bulkSelectMode = false;\nlet selectedTasks = new Set();\nlet advancedFilters = {\n  dateFrom: null,\n  dateTo: null,\n  statuses: [],\n  difficulties: [],\n  importances: [],\n};\n\n// Apply theme on load\nfunction applyTheme(theme) {\n  const body = document.body;\n  body.classList.remove(\n    \"light-mode\",\n    \"dark-mode\",\n    \"blue-theme\",\n    \"green-theme\",\n    \"pink-theme\",\n    \"orange-theme\"\n  );\n\n  if (theme === \"light\") {\n    body.classList.add(\"light-mode\");\n  } else if (theme === \"dark\") {\n    body.classList.add(\"dark-mode\");\n  } else {\n    body.classList.add(theme + \"-theme\", \"dark-mode\");\n  }\n\n  currentTheme = theme;\n  localStorage.setItem(\"appTheme\", theme);\n  // Also update defaultTheme to keep settings in sync\n  localStorage.setItem(\"defaultTheme\", theme);\n\n  // Update active theme button\n  document.querySelectorAll(\".theme-btn\").forEach((btn) => {\n    btn.classList.toggle(\"active\", btn.dataset.theme === theme);\n  });\n}\n\n// Theme button event listeners\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  document.querySelectorAll(\".theme-btn\").forEach((btn) => {\n    btn.addEventListener(\"click\", () => {\n      applyTheme(btn.dataset.theme);\n      showNotification(\n        `${\n          btn.dataset.theme.charAt(0).toUpperCase() + btn.dataset.theme.slice(1)\n        } theme applied!`,\n        \"success\"\n      );\n    });\n  });\n\n  // Apply saved theme\n  applyTheme(currentTheme);\n});\n\n// Layout System\nfunction switchLayout(layout) {\n  // Hide all views\n  document.getElementById(\"kanban-view\").style.display = \"none\";\n  document.getElementById(\"list-view\").style.display = \"none\";\n  document.getElementById(\"grid-view\").style.display = \"none\";\n  document.getElementById(\"timeline-view\").style.display = \"none\";\n  document.getElementById(\"calendar-view\").style.display = \"none\";\n\n  // Show selected view\n  if (layout === \"kanban\") {\n    document.getElementById(\"kanban-view\").style.display = \"grid\";\n    renderTasks();\n  } else if (layout === \"list\") {\n    document.getElementById(\"list-view\").style.display = \"block\";\n    renderListView();\n  } else if (layout === \"grid\") {\n    document.getElementById(\"grid-view\").style.display = \"block\";\n    renderGridView();\n  } else if (layout === \"timeline\") {\n    document.getElementById(\"timeline-view\").style.display = \"block\";\n    renderTimelineView();\n  }\n\n  currentLayout = layout;\n  localStorage.setItem(\"appLayout\", layout);\n\n  // Update active layout button\n  document.querySelectorAll(\".layout-btn\").forEach((btn) => {\n    btn.classList.toggle(\"active\", btn.dataset.layout === layout);\n  });\n}\n\n// Layout button event listeners\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  document.querySelectorAll(\".layout-btn\").forEach((btn) => {\n    btn.addEventListener(\"click\", () => {\n      switchLayout(btn.dataset.layout);\n    });\n  });\n\n  // Apply saved layout\n  switchLayout(currentLayout);\n});\n\n// Density System\nfunction applyDensity(density) {\n  document.body.classList.remove(\"compact-mode\", \"relaxed-mode\");\n  document.body.classList.add(density + \"-mode\");\n\n  currentDensity = density;\n  localStorage.setItem(\"appDensity\", density);\n\n  // Update active density button\n  document.querySelectorAll(\".density-btn\").forEach((btn) => {\n    btn.classList.toggle(\"active\", btn.dataset.density === density);\n  });\n}\n\n// Density button event listeners\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  document.querySelectorAll(\".density-btn\").forEach((btn) => {\n    btn.addEventListener(\"click\", () => {\n      applyDensity(btn.dataset.density);\n      showNotification(\n        `${\n          btn.dataset.density.charAt(0).toUpperCase() +\n          btn.dataset.density.slice(1)\n        } mode applied!`,\n        \"success\"\n      );\n    });\n  });\n\n  // Apply saved density\n  applyDensity(currentDensity);\n});\n\n// List View Rendering\nfunction renderListView() {\n  const container = document.getElementById(\"list-container\");\n  container.innerHTML = \"\";\n\n  const activeTasks = tasks.filter((task) => !task.archived && !task.deleted);\n\n  if (activeTasks.length === 0) {\n    container.innerHTML =\n      '<div class=\"empty-state\"><i class=\"fas fa-list\"></i><p>No tasks found</p></div>';\n    return;\n  }\n\n  activeTasks.forEach((task) => {\n    const item = document.createElement(\"div\");\n    item.className = \"list-task-item\";\n\n    const priorityClass =\n      task.importance === 3\n        ? \"task-card-priority-high\"\n        : task.importance === 2\n        ? \"task-card-priority-medium\"\n        : \"task-card-priority-low\";\n    item.classList.add(priorityClass);\n\n    item.innerHTML = `\n      <input type=\"checkbox\" class=\"list-task-checkbox\" ${\n        task.status === \"done\" ? \"checked\" : \"\"\n      }>\n      <div class=\"list-task-content\">\n        <div class=\"list-task-title\">${task.title}</div>\n        <div class=\"list-task-meta\">\n          <span class=\"task-difficulty ${task.difficulty}\">${\n      task.difficulty\n    }</span>\n          <span class=\"task-date\">${task.dueDate || \"No due date\"}</span>\n          <span class=\"task-importance\" data-importance=\"${task.importance}\">${\n      task.importance\n    }</span>\n        </div>\n      </div>\n    `;\n\n    item\n      .querySelector(\".list-task-checkbox\")\n      .addEventListener(\"change\", (e) => {\n        updateTaskStatus(task.id, e.target.checked ? \"done\" : \"todo\");\n      });\n\n    item.addEventListener(\"click\", (e) => {\n      if (e.target.type !== \"checkbox\") {\n        editTask(task.id);\n      }\n    });\n\n    container.appendChild(item);\n  });\n}\n\n// Grid View Rendering\nfunction renderGridView() {\n  const container = document.getElementById(\"grid-container\");\n  container.innerHTML = \"\";\n\n  const activeTasks = tasks.filter((task) => !task.archived && !task.deleted);\n\n  if (activeTasks.length === 0) {\n    container.innerHTML =\n      '<div class=\"empty-state\"><i class=\"fas fa-th\"></i><p>No tasks found</p></div>';\n    return;\n  }\n\n  activeTasks.forEach((task) => {\n    const card = createTaskElement(task);\n    card.classList.add(\"grid-task-card\");\n    container.appendChild(card);\n  });\n}\n\n// Timeline View Rendering\nfunction renderTimelineView() {\n  const container = document.getElementById(\"timeline-container\");\n  container.innerHTML = \"\";\n\n  const activeTasks = tasks.filter(\n    (task) => !task.archived && !task.deleted && task.dueDate\n  );\n\n  if (activeTasks.length === 0) {\n    container.innerHTML =\n      '<div class=\"empty-state\"><i class=\"fas fa-stream\"></i><p>No tasks with due dates found</p></div>';\n    return;\n  }\n\n  // Sort by due date\n  activeTasks.sort((a, b) => new Date(a.dueDate) - new Date(b.dueDate));\n\n  activeTasks.forEach((task) => {\n    const item = document.createElement(\"div\");\n    item.className = \"timeline-item\";\n\n    item.innerHTML = `\n      <div class=\"timeline-date\">${new Date(task.dueDate).toLocaleDateString(\n        \"en-US\",\n        { weekday: \"long\", year: \"numeric\", month: \"long\", day: \"numeric\" }\n      )}</div>\n      <h3 class=\"task-title\">${task.title}</h3>\n      <p class=\"task-description\">${task.description || \"No description\"}</p>\n      <div class=\"task-meta\">\n        <span class=\"task-difficulty ${task.difficulty}\">${\n      task.difficulty\n    }</span>\n        <span class=\"task-importance\" data-importance=\"${task.importance}\">${\n      task.importance\n    }</span>\n      </div>\n    `;\n\n    item.addEventListener(\"click\", () => editTask(task.id));\n    container.appendChild(item);\n  });\n}\n\n// Advanced Search/Filter\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  const toggleBtn = document.getElementById(\"toggle-advanced-search\");\n  const content = document.getElementById(\"advanced-search-content\");\n  const applyBtn = document.getElementById(\"apply-filters\");\n  const clearBtn = document.getElementById(\"clear-filters\");\n\n  if (toggleBtn) {\n    toggleBtn.addEventListener(\"click\", () => {\n      const isHidden = content.style.display === \"none\";\n      content.style.display = isHidden ? \"block\" : \"none\";\n      toggleBtn.innerHTML = isHidden\n        ? '<i class=\"fas fa-filter\"></i>Hide Filters'\n        : '<i class=\"fas fa-filter\"></i>Advanced Filters';\n    });\n  }\n\n  if (applyBtn) {\n    applyBtn.addEventListener(\"click\", () => {\n      advancedFilters.dateFrom =\n        document.getElementById(\"filter-date-from\").value;\n      advancedFilters.dateTo = document.getElementById(\"filter-date-to\").value;\n      advancedFilters.statuses = Array.from(\n        document.getElementById(\"filter-status\").selectedOptions\n      ).map((o) => o.value);\n      advancedFilters.difficulties = Array.from(\n        document.getElementById(\"filter-difficulty\").selectedOptions\n      ).map((o) => o.value);\n      advancedFilters.importances = Array.from(\n        document.getElementById(\"filter-importance\").selectedOptions\n      ).map((o) => o.value);\n\n      applyAdvancedFilters();\n      showNotification(\"Filters applied!\", \"success\");\n    });\n  }\n\n  if (clearBtn) {\n    clearBtn.addEventListener(\"click\", () => {\n      document.getElementById(\"filter-date-from\").value = \"\";\n      document.getElementById(\"filter-date-to\").value = \"\";\n      document.getElementById(\"filter-status\").selectedIndex = -1;\n      document.getElementById(\"filter-difficulty\").selectedIndex = -1;\n      document.getElementById(\"filter-importance\").selectedIndex = -1;\n\n      advancedFilters = {\n        dateFrom: null,\n        dateTo: null,\n        statuses: [],\n        difficulties: [],\n        importances: [],\n      };\n      filterAndRenderTasks();\n      showNotification(\"Filters cleared!\", \"info\");\n    });\n  }\n});\n\nfunction applyAdvancedFilters() {\n  let filteredTasks = [...tasks].filter(\n    (task) => !task.archived && !task.deleted\n  );\n\n  // Date range filter\n  if (advancedFilters.dateFrom) {\n    filteredTasks = filteredTasks.filter(\n      (task) => task.dueDate >= advancedFilters.dateFrom\n    );\n  }\n  if (advancedFilters.dateTo) {\n    filteredTasks = filteredTasks.filter(\n      (task) => task.dueDate <= advancedFilters.dateTo\n    );\n  }\n\n  // Status filter\n  if (advancedFilters.statuses.length > 0) {\n    filteredTasks = filteredTasks.filter((task) =>\n      advancedFilters.statuses.includes(task.status)\n    );\n  }\n\n  // Difficulty filter\n  if (advancedFilters.difficulties.length > 0) {\n    filteredTasks = filteredTasks.filter((task) =>\n      advancedFilters.difficulties.includes(task.difficulty)\n    );\n  }\n\n  // Importance filter\n  if (advancedFilters.importances.length > 0) {\n    filteredTasks = filteredTasks.filter((task) =>\n      advancedFilters.importances.includes(String(task.importance))\n    );\n  }\n\n  renderTasks(filteredTasks);\n}\n\n// Bulk Selection System\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  const bulkToggleBtn = document.getElementById(\"bulk-select-toggle\");\n  const bulkActionsBtn = document.getElementById(\"bulk-actions-btn\");\n\n  if (bulkToggleBtn) {\n    bulkToggleBtn.addEventListener(\"click\", () => {\n      bulkSelectMode = !bulkSelectMode;\n      selectedTasks.clear();\n\n      if (bulkSelectMode) {\n        bulkToggleBtn.innerHTML = '<i class=\"fas fa-times\"></i>Cancel';\n        bulkActionsBtn.style.display = \"flex\";\n        document.querySelectorAll(\".task-card\").forEach((card) => {\n          card.classList.add(\"bulk-select-mode\");\n          card.addEventListener(\"click\", handleBulkSelect);\n        });\n      } else {\n        bulkToggleBtn.innerHTML =\n          '<i class=\"fas fa-check-square\"></i>Bulk Select';\n        bulkActionsBtn.style.display = \"none\";\n        document.querySelectorAll(\".task-card\").forEach((card) => {\n          card.classList.remove(\"bulk-select-mode\", \"selected\");\n          card.removeEventListener(\"click\", handleBulkSelect);\n        });\n      }\n    });\n  }\n\n  if (bulkActionsBtn) {\n    bulkActionsBtn.addEventListener(\"click\", () => {\n      if (selectedTasks.size > 0) {\n        openModal(document.getElementById(\"bulk-actions-modal\"));\n        document.getElementById(\"selected-count\").textContent =\n          selectedTasks.size;\n      } else {\n        showNotification(\"No tasks selected\", \"warning\");\n      }\n    });\n  }\n});\n\nfunction handleBulkSelect(e) {\n  e.stopPropagation();\n  const taskId = this.dataset.id;\n\n  if (selectedTasks.has(taskId)) {\n    selectedTasks.delete(taskId);\n    this.classList.remove(\"selected\");\n  } else {\n    selectedTasks.add(taskId);\n    this.classList.add(\"selected\");\n  }\n}\n\n// Bulk Actions\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  document.getElementById(\"bulk-complete\")?.addEventListener(\"click\", () => {\n    selectedTasks.forEach((taskId) => updateTaskStatus(taskId, \"done\"));\n    showNotification(\n      `${selectedTasks.size} tasks marked as complete`,\n      \"success\"\n    );\n    closeModal(document.getElementById(\"bulk-actions-modal\"));\n    selectedTasks.clear();\n  });\n\n  document.getElementById(\"bulk-archive\")?.addEventListener(\"click\", () => {\n    selectedTasks.forEach((taskId) => archiveTaskById(taskId));\n    showNotification(`${selectedTasks.size} tasks archived`, \"success\");\n    closeModal(document.getElementById(\"bulk-actions-modal\"));\n    selectedTasks.clear();\n  });\n\n  document.getElementById(\"bulk-delete\")?.addEventListener(\"click\", () => {\n    showConfirmation(\n      \"Delete Tasks\",\n      `Are you sure you want to delete ${selectedTasks.size} tasks?`,\n      () => {\n        selectedTasks.forEach((taskId) => moveToTrash(taskId));\n        showNotification(\n          `${selectedTasks.size} tasks moved to trash`,\n          \"success\"\n        );\n        closeModal(document.getElementById(\"bulk-actions-modal\"));\n        selectedTasks.clear();\n      }\n    );\n  });\n\n  document.getElementById(\"close-bulk-modal\")?.addEventListener(\"click\", () => {\n    closeModal(document.getElementById(\"bulk-actions-modal\"));\n  });\n});\n\nfunction archiveTaskById(taskId) {\n  if (currentUser) {\n    db.collection(\"users\")\n      .doc(currentUser.uid)\n      .collection(\"tasks\")\n      .doc(taskId)\n      .update({\n        archived: true,\n        updatedAt: firebase.firestore.FieldValue.serverTimestamp(),\n      });\n  } else {\n    const task = tasks.find((t) => t.id === taskId);\n    if (task) task.archived = true;\n    saveTasksToLocalStorage();\n    renderTasks();\n  }\n}\n\n// Trash System\nfunction moveToTrash(taskId) {\n  if (currentUser) {\n    db.collection(\"users\")\n      .doc(currentUser.uid)\n      .collection(\"tasks\")\n      .doc(taskId)\n      .update({\n        deleted: true,\n        deletedAt: firebase.firestore.FieldValue.serverTimestamp(),\n        updatedAt: firebase.firestore.FieldValue.serverTimestamp(),\n      });\n  } else {\n    const task = tasks.find((t) => t.id === taskId);\n    if (task) {\n      task.deleted = true;\n      task.deletedAt = new Date().toISOString();\n    }\n    saveTasksToLocalStorage();\n    renderTasks();\n  }\n}\n\nfunction restoreFromTrash(taskId) {\n  if (currentUser) {\n    db.collection(\"users\")\n      .doc(currentUser.uid)\n      .collection(\"tasks\")\n      .doc(taskId)\n      .update({\n        deleted: false,\n        deletedAt: null,\n        updatedAt: firebase.firestore.FieldValue.serverTimestamp(),\n      });\n  } else {\n    const task = tasks.find((t) => t.id === taskId);\n    if (task) {\n      task.deleted = false;\n      task.deletedAt = null;\n    }\n    saveTasksToLocalStorage();\n    renderTasks();\n  }\n  showNotification(\"Task restored!\", \"success\");\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  document.getElementById(\"show-trash\")?.addEventListener(\"click\", showTrash);\n  document\n    .getElementById(\"close-trash-modal\")\n    ?.addEventListener(\"click\", () => {\n      closeModal(document.getElementById(\"trash-modal-overlay\"));\n    });\n  document.getElementById(\"empty-trash\")?.addEventListener(\"click\", emptyTrash);\n});\n\nfunction showTrash() {\n  const trashedTasks = tasks.filter((task) => task.deleted);\n  const container = document.getElementById(\"trash-tasks-list\");\n  container.innerHTML = \"\";\n\n  if (trashedTasks.length === 0) {\n    container.innerHTML =\n      '<div class=\"empty-state\"><i class=\"fas fa-trash-alt\"></i><p>Trash is empty</p></div>';\n  } else {\n    trashedTasks.forEach((task) => {\n      const taskElement = document.createElement(\"div\");\n      taskElement.className = \"task-card\";\n      taskElement.innerHTML = `\n        <h3 class=\"task-title\">${task.title}</h3>\n        <p class=\"task-description\">${task.description || \"No description\"}</p>\n        <div class=\"task-actions\">\n          <button class=\"btn-success restore-btn\" data-id=\"${task.id}\">\n            <i class=\"fas fa-undo\"></i>Restore\n          </button>\n          <button class=\"btn-danger delete-permanent-btn\" data-id=\"${task.id}\">\n            <i class=\"fas fa-trash\"></i>Delete Forever\n          </button>\n        </div>\n      `;\n\n      taskElement\n        .querySelector(\".restore-btn\")\n        .addEventListener(\"click\", () => {\n          restoreFromTrash(task.id);\n          showTrash();\n        });\n\n      taskElement\n        .querySelector(\".delete-permanent-btn\")\n        .addEventListener(\"click\", () => {\n          showConfirmation(\n            \"Delete Forever\",\n            \"This action cannot be undone!\",\n            () => {\n              permanentlyDeleteTask(task.id);\n              showTrash();\n            }\n          );\n        });\n\n      container.appendChild(taskElement);\n    });\n  }\n\n  openModal(document.getElementById(\"trash-modal-overlay\"));\n}\n\nfunction emptyTrash() {\n  showConfirmation(\n    \"Empty Trash\",\n    \"Permanently delete all tasks in trash? This cannot be undone!\",\n    () => {\n      const trashedTasks = tasks.filter((task) => task.deleted);\n      trashedTasks.forEach((task) => permanentlyDeleteTask(task.id));\n      showNotification(\"Trash emptied\", \"success\");\n      closeModal(document.getElementById(\"trash-modal-overlay\"));\n    }\n  );\n}\n\nfunction permanentlyDeleteTask(taskId) {\n  if (currentUser) {\n    db.collection(\"users\")\n      .doc(currentUser.uid)\n      .collection(\"tasks\")\n      .doc(taskId)\n      .delete();\n  } else {\n    tasks = tasks.filter((t) => t.id !== taskId);\n    saveTasksToLocalStorage();\n    renderTasks();\n  }\n}\n\n// Onboarding System\nlet onboardingStep = 1;\nconst totalOnboardingSteps = 5;\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  // Check if user has seen onboarding\n  const hasSeenOnboarding = localStorage.getItem(\"hasSeenOnboarding\");\n  if (!hasSeenOnboarding) {\n    setTimeout(() => {\n      openModal(document.getElementById(\"onboarding-modal\"));\n    }, 1000);\n  }\n\n  document\n    .getElementById(\"onboarding-next\")\n    ?.addEventListener(\"click\", nextOnboardingStep);\n  document\n    .getElementById(\"onboarding-prev\")\n    ?.addEventListener(\"click\", prevOnboardingStep);\n  document\n    .getElementById(\"onboarding-finish\")\n    ?.addEventListener(\"click\", finishOnboarding);\n  document\n    .getElementById(\"close-onboarding\")\n    ?.addEventListener(\"click\", finishOnboarding);\n});\n\nfunction nextOnboardingStep() {\n  if (onboardingStep < totalOnboardingSteps) {\n    onboardingStep++;\n    updateOnboardingStep();\n  }\n}\n\nfunction prevOnboardingStep() {\n  if (onboardingStep > 1) {\n    onboardingStep--;\n    updateOnboardingStep();\n  }\n}\n\nfunction updateOnboardingStep() {\n  document.querySelectorAll(\".onboarding-step\").forEach((step, index) => {\n    step.classList.toggle(\"active\", index + 1 === onboardingStep);\n  });\n\n  document.querySelectorAll(\".dot\").forEach((dot, index) => {\n    dot.classList.toggle(\"active\", index + 1 === onboardingStep);\n  });\n\n  document.getElementById(\"onboarding-prev\").style.display =\n    onboardingStep === 1 ? \"none\" : \"flex\";\n  document.getElementById(\"onboarding-next\").style.display =\n    onboardingStep === totalOnboardingSteps ? \"none\" : \"flex\";\n  document.getElementById(\"onboarding-finish\").style.display =\n    onboardingStep === totalOnboardingSteps ? \"flex\" : \"none\";\n}\n\nfunction finishOnboarding() {\n  localStorage.setItem(\"hasSeenOnboarding\", \"true\");\n  closeModal(document.getElementById(\"onboarding-modal\"));\n  onboardingStep = 1;\n  updateOnboardingStep();\n}\n\n// Confirmation Dialog\nfunction showConfirmation(title, message, onConfirm) {\n  const dialog = document.getElementById(\"confirmation-dialog\");\n  document.getElementById(\"confirmation-title\").textContent = title;\n  document.getElementById(\"confirmation-message\").textContent = message;\n\n  const confirmBtn = document.getElementById(\"confirmation-confirm\");\n  const cancelBtn = document.getElementById(\"confirmation-cancel\");\n\n  const handleConfirm = () => {\n    onConfirm();\n    closeModal(dialog);\n    confirmBtn.removeEventListener(\"click\", handleConfirm);\n  };\n\n  const handleCancel = () => {\n    closeModal(dialog);\n    confirmBtn.removeEventListener(\"click\", handleConfirm);\n  };\n\n  confirmBtn.addEventListener(\"click\", handleConfirm);\n  cancelBtn.addEventListener(\"click\", handleCancel);\n\n  openModal(dialog);\n}\n\n// Analytics Collapse\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  document\n    .getElementById(\"collapse-analytics\")\n    ?.addEventListener(\"click\", function () {\n      const content = document.getElementById(\"charts-content\");\n      const isCollapsed = content.classList.contains(\"collapsed\");\n\n      content.classList.toggle(\"collapsed\");\n      this.classList.toggle(\"collapsed\");\n      this.querySelector(\"i\").className = isCollapsed\n        ? \"fas fa-chevron-up\"\n        : \"fas fa-chevron-down\";\n    });\n});\n\n// Smart Reminders (Basic Implementation)\nfunction checkSmartReminders() {\n  const now = new Date();\n  const threeDaysAgo = new Date(now.getTime() - 3 * 24 * 60 * 60 * 1000);\n\n  tasks.forEach((task) => {\n    if (!task.archived && !task.deleted && task.status !== \"done\") {\n      const lastUpdated = task.updatedAt\n        ? new Date(task.updatedAt)\n        : new Date(task.createdAt);\n\n      if (lastUpdated < threeDaysAgo) {\n        showNotification(\n          `Reminder: You haven't worked on \"${task.title}\" in 3 days!`,\n          \"warning\"\n        );\n      }\n    }\n  });\n}\n\n// Run smart reminders check periodically\nsetInterval(checkSmartReminders, 60 * 60 * 1000); // Check every hour\n\n// Sentiment Detection (Basic Implementation)\nfunction detectUrgency(description) {\n  const urgentKeywords = [\n    \"urgent\",\n    \"asap\",\n    \"immediately\",\n    \"critical\",\n    \"emergency\",\n    \"important\",\n    \"priority\",\n  ];\n  const lowerDesc = description.toLowerCase();\n\n  for (const keyword of urgentKeywords) {\n    if (lowerDesc.includes(keyword)) {\n      return 3; // High importance\n    }\n  }\n\n  return 1; // Default to low\n}\n\n// Auto-adjust importance based on description\ndocument\n  .getElementById(\"task-description\")\n  ?.addEventListener(\"blur\", function () {\n    const description = this.value;\n    if (description) {\n      const detectedImportance = detectUrgency(description);\n      if (detectedImportance === 3) {\n        document.querySelectorAll(\".importance-option\").forEach((opt) => {\n          opt.classList.toggle(\"selected\", opt.dataset.importance === \"3\");\n        });\n        showNotification(\"High importance detected from description!\", \"info\");\n      }\n    }\n  });\n\nconsole.log(\"All new features initialized successfully!\");\n\n// ========== CUSTOM TAGS SYSTEM ==========\nlet customTags = JSON.parse(localStorage.getItem(\"customTags\")) || [\n  { name: \"Work\", color: \"#0984e3\" },\n  { name: \"Personal\", color: \"#00b894\" },\n  { name: \"Urgent\", color: \"#d63031\" },\n];\n\n// Save custom tags to localStorage\nfunction saveCustomTags() {\n  localStorage.setItem(\"customTags\", JSON.stringify(customTags));\n  updateTagsFilter();\n  updateTaskTagsOptions();\n}\n\n// Update tags filter dropdown\nfunction updateTagsFilter() {\n  const tagsFilter = document.getElementById(\"tags-filter\");\n  if (!tagsFilter) return;\n\n  tagsFilter.innerHTML = '<option value=\"all\">All Tags</option>';\n  customTags.forEach((tag) => {\n    const option = document.createElement(\"option\");\n    option.value = tag.name;\n    option.textContent = tag.name;\n    tagsFilter.appendChild(option);\n  });\n}\n\n// Update task tags options in forms\nfunction updateTaskTagsOptions() {\n  const taskTagsSelects = [\n    document.getElementById(\"task-tags\"),\n    document.getElementById(\"modal-task-tags\"),\n  ];\n\n  taskTagsSelects.forEach((select) => {\n    if (!select) return;\n    const selectedValues = Array.from(select.selectedOptions).map(\n      (o) => o.value\n    );\n    select.innerHTML = \"\";\n\n    customTags.forEach((tag) => {\n      const option = document.createElement(\"option\");\n      option.value = tag.name;\n      option.textContent = tag.name;\n      option.style.backgroundColor = tag.color;\n      option.style.color = \"white\";\n      if (selectedValues.includes(tag.name)) {\n        option.selected = true;\n      }\n      select.appendChild(option);\n    });\n  });\n}\n\n// Show tags management modal\nfunction showTagsManager() {\n  const tagsList = document.getElementById(\"tags-list\");\n  tagsList.innerHTML = \"\";\n\n  if (customTags.length === 0) {\n    tagsList.innerHTML =\n      '<p style=\"color: var(--muted); text-align: center;\">No tags yet. Add one below!</p>';\n  } else {\n    customTags.forEach((tag, index) => {\n      const tagItem = document.createElement(\"div\");\n      tagItem.className = \"tag-item\";\n      tagItem.style.backgroundColor = tag.color;\n      tagItem.innerHTML = `\n        <span>${tag.name}</span>\n        <button class=\"delete-tag\" data-index=\"${index}\">\n          <i class=\"fas fa-times\"></i>\n        </button>\n      `;\n\n      tagItem.querySelector(\".delete-tag\").addEventListener(\"click\", (e) => {\n        e.stopPropagation();\n        deleteTag(index);\n      });\n\n      tagsList.appendChild(tagItem);\n    });\n  }\n\n  openModal(document.getElementById(\"tags-modal-overlay\"));\n}\n\n// Add new tag\nfunction addTag() {\n  const nameInput = document.getElementById(\"new-tag-name\");\n  const colorInput = document.getElementById(\"new-tag-color\");\n\n  const name = nameInput.value.trim();\n  const color = colorInput.value;\n\n  if (!name) {\n    showNotification(\"Tag name is required\", \"error\");\n    return;\n  }\n\n  // Check if tag already exists\n  if (customTags.some((tag) => tag.name.toLowerCase() === name.toLowerCase())) {\n    showNotification(\"Tag already exists\", \"error\");\n    return;\n  }\n\n  customTags.push({ name, color });\n  saveCustomTags();\n\n  nameInput.value = \"\";\n  colorInput.value = \"#6c5ce7\";\n\n  showTagsManager();\n  showNotification(`Tag \"${name}\" added!`, \"success\");\n}\n\n// Delete tag\nfunction deleteTag(index) {\n  const tag = customTags[index];\n  showConfirmation(\"Delete Tag\", `Delete \"${tag.name}\" tag?`, () => {\n    customTags.splice(index, 1);\n    saveCustomTags();\n    showTagsManager();\n    showNotification(`Tag \"${tag.name}\" deleted`, \"success\");\n  });\n}\n\n// Initialize tags system\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  updateTagsFilter();\n  updateTaskTagsOptions();\n\n  document\n    .getElementById(\"manage-tags-btn\")\n    ?.addEventListener(\"click\", showTagsManager);\n  document.getElementById(\"close-tags-modal\")?.addEventListener(\"click\", () => {\n    closeModal(document.getElementById(\"tags-modal-overlay\"));\n  });\n  document.getElementById(\"add-tag-btn\")?.addEventListener(\"click\", addTag);\n\n  // Allow Enter key to add tag\n  document.getElementById(\"new-tag-name\")?.addEventListener(\"keypress\", (e) => {\n    if (e.key === \"Enter\") {\n      addTag();\n    }\n  });\n});\n\n// Enhanced task card rendering with custom tag colors\nconst originalCreateTaskElement = createTaskElement;\ncreateTaskElement = function (task) {\n  const taskElement = originalCreateTaskElement(task);\n\n  // Add priority border\n  if (task.importance === 3) {\n    taskElement.classList.add(\"task-card-priority-high\");\n  } else if (task.importance === 2) {\n    taskElement.classList.add(\"task-card-priority-medium\");\n  } else {\n    taskElement.classList.add(\"task-card-priority-low\");\n  }\n\n  // Update tag colors\n  const tagsContainer = taskElement.querySelector(\".task-tags\");\n  if (tagsContainer && task.tags) {\n    tagsContainer.innerHTML = \"\";\n    task.tags.forEach((tagName) => {\n      const tagConfig = customTags.find((t) => t.name === tagName);\n      const tagElement = document.createElement(\"span\");\n      tagElement.className = \"task-tag\";\n      tagElement.textContent = tagName;\n      if (tagConfig) {\n        tagElement.style.backgroundColor = tagConfig.color;\n      }\n      tagsContainer.appendChild(tagElement);\n    });\n  }\n\n  // Add task icons\n  const metaDiv = taskElement.querySelector(\".task-meta\");\n  if (metaDiv) {\n    const iconsDiv = document.createElement(\"div\");\n    iconsDiv.className = \"task-icons\";\n\n    // Difficulty icon\n    const difficultyIcon = document.createElement(\"div\");\n    difficultyIcon.className = \"task-icon icon-difficulty\";\n    difficultyIcon.title = `Difficulty: ${task.difficulty}`;\n    difficultyIcon.innerHTML =\n      task.difficulty === \"hard\"\n        ? '<i class=\"fas fa-fire\"></i>'\n        : task.difficulty === \"medium\"\n        ? '<i class=\"fas fa-bolt\"></i>'\n        : '<i class=\"fas fa-leaf\"></i>';\n    iconsDiv.appendChild(difficultyIcon);\n\n    // Importance icon\n    const importanceIcon = document.createElement(\"div\");\n    importanceIcon.className = \"task-icon icon-importance\";\n    importanceIcon.title = `Importance: ${task.importance}`;\n    importanceIcon.innerHTML = '<i class=\"fas fa-exclamation\"></i>';\n    iconsDiv.appendChild(importanceIcon);\n\n    // Overdue icon\n    if (\n      task.dueDate &&\n      new Date(task.dueDate) < new Date() &&\n      task.status !== \"done\"\n    ) {\n      const overdueIcon = document.createElement(\"div\");\n      overdueIcon.className = \"task-icon icon-overdue\";\n      overdueIcon.title = \"Overdue!\";\n      overdueIcon.innerHTML = '<i class=\"fas fa-clock\"></i>';\n      iconsDiv.appendChild(overdueIcon);\n    }\n\n    metaDiv.appendChild(iconsDiv);\n  }\n\n  return taskElement;\n};\n\n// Error validation for task form\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  const taskForm = document.querySelector(\".task-form\");\n  const startTimeInput = document.getElementById(\"task-start-time\");\n  const endTimeInput = document.getElementById(\"task-end-time\");\n  const dueDateInput = document.getElementById(\"task-due-date\");\n\n  // Validate time range\n  function validateTimeRange() {\n    if (startTimeInput.value && endTimeInput.value) {\n      const start = new Date(`2000-01-01T${startTimeInput.value}`);\n      const end = new Date(`2000-01-01T${endTimeInput.value}`);\n\n      if (end <= start) {\n        showNotification(\"End time must be after start time\", \"error\");\n        endTimeInput.value = \"\";\n        return false;\n      }\n    }\n    return true;\n  }\n\n  startTimeInput?.addEventListener(\"change\", validateTimeRange);\n  endTimeInput?.addEventListener(\"change\", validateTimeRange);\n\n  // Validate due date (warn if in the past)\n  dueDateInput?.addEventListener(\"change\", function () {\n    const selectedDate = new Date(this.value);\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n\n    if (selectedDate < today) {\n      showNotification(\"Due date is in the past\", \"warning\");\n    }\n  });\n});\n\n// Add keyboard shortcut hints\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  // Show keyboard shortcuts on Ctrl+?\n  document.addEventListener(\"keydown\", (e) => {\n    if (e.ctrlKey && e.key === \"/\") {\n      e.preventDefault();\n      showNotification(\n        \"Shortcuts: Ctrl+N (New Task), Ctrl+F (Search), Ctrl+, (Settings), Esc (Close)\",\n        \"info\"\n      );\n    }\n  });\n});\n\nconsole.log(\"Custom tags system and enhancements initialized!\");\n\n// ========== HELP MODAL TABS ==========\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  const helpTabs = document.querySelectorAll(\".help-tab\");\n  const helpTabContents = document.querySelectorAll(\".help-tab-content\");\n\n  helpTabs.forEach((tab) => {\n    tab.addEventListener(\"click\", () => {\n      const targetTab = tab.dataset.tab;\n\n      // Remove active class from all tabs and contents\n      helpTabs.forEach((t) => t.classList.remove(\"active\"));\n      helpTabContents.forEach((content) => content.classList.remove(\"active\"));\n\n      // Add active class to clicked tab and corresponding content\n      tab.classList.add(\"active\");\n      document.getElementById(targetTab)?.classList.add(\"active\");\n    });\n  });\n});\n\nconsole.log(\"Help modal tabs initialized!\");\n\n// ========== ADDITIONAL FIXES AND ENHANCEMENTS ==========\n\n// Global settings object\nlet appSettings = {\n  reduceNotifications: false,\n  disableNotifications: false,\n  reduceMotion: false,\n  disableAnimations: false,\n  defaultView: \"kanban\",\n  defaultTheme: \"dark\",\n};\n\n// Load app settings on init\nfunction loadAppSettings() {\n  const savedSettings = localStorage.getItem(\"appSettings\");\n  if (savedSettings) {\n    appSettings = JSON.parse(savedSettings);\n  }\n\n  // Apply settings\n  if (appSettings.reduceMotion) {\n    document.body.style.setProperty(\"--transition\", \"none\");\n  }\n  if (appSettings.disableAnimations) {\n    document.body.classList.add(\"no-animations\");\n  }\n\n  // Load notification settings\n  const reduceNotifCheckbox = document.getElementById(\"reduce-notifications\");\n  const disableNotifCheckbox = document.getElementById(\"disable-notifications\");\n  if (reduceNotifCheckbox)\n    reduceNotifCheckbox.checked = appSettings.reduceNotifications;\n  if (disableNotifCheckbox)\n    disableNotifCheckbox.checked = appSettings.disableNotifications;\n}\n\n// Enhanced save settings function\nfunction saveSettingsEnhanced() {\n  const defaultTheme =\n    document.getElementById(\"default-theme\")?.value || \"dark\";\n  const defaultView =\n    document.getElementById(\"default-view\")?.value || \"kanban\";\n  const reduceMotion =\n    document.getElementById(\"reduce-motion\")?.checked || false;\n  const disableAnimations =\n    document.getElementById(\"disable-animations\")?.checked || false;\n  const reduceNotifications =\n    document.getElementById(\"reduce-notifications\")?.checked || false;\n  const disableNotifications =\n    document.getElementById(\"disable-notifications\")?.checked || false;\n\n  appSettings = {\n    defaultTheme,\n    defaultView,\n    reduceMotion,\n    disableAnimations,\n    reduceNotifications,\n    disableNotifications,\n  };\n\n  // Save to localStorage\n  localStorage.setItem(\"appSettings\", JSON.stringify(appSettings));\n  localStorage.setItem(\"defaultTheme\", defaultTheme);\n  localStorage.setItem(\"defaultView\", defaultView);\n  localStorage.setItem(\"reduceMotion\", reduceMotion);\n  localStorage.setItem(\"disableAnimations\", disableAnimations);\n\n  // Apply theme immediately\n  applyThemeEnhanced(defaultTheme);\n\n  // Apply view immediately\n  applyDefaultView(defaultView);\n\n  // Apply animation settings\n  if (reduceMotion) {\n    document.body.style.setProperty(\"--transition\", \"all 0.1s ease\");\n  } else {\n    document.body.style.setProperty(\n      \"--transition\",\n      \"all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1)\"\n    );\n  }\n\n  if (disableAnimations) {\n    document.body.classList.add(\"no-animations\");\n    const style = document.createElement(\"style\");\n    style.id = \"no-animations-style\";\n    style.textContent =\n      \"* { animation: none !important; transition: none !important; }\";\n    document.head.appendChild(style);\n  } else {\n    document.body.classList.remove(\"no-animations\");\n    const existingStyle = document.getElementById(\"no-animations-style\");\n    if (existingStyle) existingStyle.remove();\n  }\n\n  // Save to Firestore if user is logged in\n  if (currentUser) {\n    db.collection(\"users\")\n      .doc(currentUser.uid)\n      .set(\n        {\n          settings: appSettings,\n        },\n        { merge: true }\n      )\n      .catch((err) => console.error(\"Error saving settings:\", err));\n  }\n\n  showNotificationEnhanced(\"Settings saved successfully!\", \"success\");\n  closeModal(document.getElementById(\"settings-modal-overlay\"));\n}\n\n// Apply theme function\nfunction applyThemeEnhanced(theme) {\n  const body = document.body;\n  body.classList.remove(\n    \"light-mode\",\n    \"dark-mode\",\n    \"blue-theme\",\n    \"green-theme\",\n    \"pink-theme\",\n    \"orange-theme\"\n  );\n\n  if (theme === \"light\") {\n    body.classList.add(\"light-mode\");\n  } else if (theme === \"dark\") {\n    body.classList.add(\"dark-mode\");\n  } else {\n    body.classList.add(theme + \"-theme\");\n  }\n\n  localStorage.setItem(\"theme\", theme);\n}\n\n// Apply default view\nfunction applyDefaultView(view) {\n  const kanbanView = document.getElementById(\"kanban-view\");\n  const calendarView = document.getElementById(\"calendar-view\");\n  const viewToggle = document.getElementById(\"view-toggle\");\n\n  if (view === \"calendar\") {\n    if (kanbanView) kanbanView.style.display = \"none\";\n    if (calendarView) calendarView.style.display = \"block\";\n    if (viewToggle)\n      viewToggle.innerHTML = '<i class=\"fas fa-columns\"></i>Kanban View';\n    currentView = \"calendar\";\n  } else {\n    if (kanbanView) kanbanView.style.display = \"grid\";\n    if (calendarView) calendarView.style.display = \"none\";\n    if (viewToggle)\n      viewToggle.innerHTML = '<i class=\"fas fa-calendar\"></i>Calendar View';\n    currentView = \"kanban\";\n  }\n\n  localStorage.setItem(\"view\", view);\n}\n\n// Enhanced notification function with settings\nfunction showNotificationEnhanced(message, type = \"info\", isImportant = false) {\n  // Check notification settings\n  if (appSettings.disableNotifications) return;\n  if (appSettings.reduceNotifications && !isImportant) return;\n\n  const notification = document.getElementById(\"notification\");\n  const notificationIcon = document.getElementById(\"notification-icon\");\n  const notificationMessage = document.getElementById(\"notification-message\");\n\n  if (!notification || !notificationIcon || !notificationMessage) return;\n\n  notificationMessage.textContent = message;\n\n  // Set icon based on type\n  switch (type) {\n    case \"success\":\n      notificationIcon.className = \"fas fa-check-circle\";\n      notification.style.borderLeft = \"4px solid var(--success)\";\n      break;\n    case \"error\":\n      notificationIcon.className = \"fas fa-exclamation-circle\";\n      notification.style.borderLeft = \"4px solid var(--danger)\";\n      break;\n    case \"warning\":\n      notificationIcon.className = \"fas fa-exclamation-triangle\";\n      notification.style.borderLeft = \"4px solid var(--warning)\";\n      break;\n    default:\n      notificationIcon.className = \"fas fa-info-circle\";\n      notification.style.borderLeft = \"4px solid var(--info)\";\n  }\n\n  notification.classList.add(\"show\");\n\n  setTimeout(() => {\n    notification.classList.remove(\"show\");\n  }, 5000);\n}\n\n// Profile picture handling\nfunction setupProfilePicture() {\n  const profilePicture = document.getElementById(\"profile-picture\");\n  const profilePictureUpload = document.getElementById(\n    \"profile-picture-upload\"\n  );\n  const changeProfilePictureBtn = document.getElementById(\n    \"change-profile-picture-btn\"\n  );\n\n  if (changeProfilePictureBtn && profilePictureUpload) {\n    changeProfilePictureBtn.addEventListener(\"click\", () => {\n      profilePictureUpload.click();\n    });\n  }\n\n  if (profilePictureUpload && profilePicture) {\n    profilePictureUpload.addEventListener(\"change\", (e) => {\n      const file = e.target.files[0];\n      if (file) {\n        const reader = new FileReader();\n        reader.onload = (event) => {\n          profilePicture.src = event.target.result;\n\n          // Save to localStorage\n          localStorage.setItem(\"profilePicture\", event.target.result);\n\n          // Save to Firestore if logged in\n          if (currentUser) {\n            db.collection(\"users\")\n              .doc(currentUser.uid)\n              .set(\n                {\n                  profilePicture: event.target.result,\n                },\n                { merge: true }\n              )\n              .then(() => {\n                showNotificationEnhanced(\n                  \"Profile picture updated!\",\n                  \"success\",\n                  true\n                );\n              })\n              .catch((err) => {\n                console.error(\"Error updating profile picture:\", err);\n                showNotificationEnhanced(\n                  \"Error updating profile picture\",\n                  \"error\",\n                  true\n                );\n              });\n          } else {\n            showNotificationEnhanced(\n              \"Profile picture updated!\",\n              \"success\",\n              true\n            );\n          }\n        };\n        reader.readAsDataURL(file);\n      }\n    });\n  }\n\n  // Load saved profile picture\n  const savedPicture = localStorage.getItem(\"profilePicture\");\n  if (savedPicture && profilePicture) {\n    profilePicture.src = savedPicture;\n  }\n\n  // Load from Google if signed in with Google\n  if (currentUser && currentUser.photoURL && profilePicture) {\n    profilePicture.src = currentUser.photoURL;\n  }\n}\n\n// Enhanced modal open/close with proper centering\nfunction openModalEnhanced(modal) {\n  if (!modal) return;\n  modal.classList.add(\"show\");\n  modal.style.display = \"flex\";\n}\n\nfunction closeModalEnhanced(modal) {\n  if (!modal) return;\n  modal.classList.remove(\"show\");\n  setTimeout(() => {\n    modal.style.display = \"none\";\n  }, 300);\n}\n\n// Fix bulk actions\nfunction setupBulkActions() {\n  const bulkSelectToggle = document.getElementById(\"bulk-select-toggle\");\n  const bulkActionsBtn = document.getElementById(\"bulk-actions-btn\");\n  const bulkActionsModal = document.getElementById(\"bulk-actions-modal\");\n  const closeBulkModal = document.getElementById(\"close-bulk-modal\");\n\n  let bulkSelectMode = false;\n  let selectedTasks = new Set();\n\n  if (bulkSelectToggle) {\n    bulkSelectToggle.addEventListener(\"click\", () => {\n      bulkSelectMode = !bulkSelectMode;\n\n      if (bulkSelectMode) {\n        bulkSelectToggle.innerHTML = '<i class=\"fas fa-times\"></i>Cancel';\n        bulkSelectToggle.classList.add(\"btn-danger\");\n        bulkSelectToggle.classList.remove(\"btn-info\");\n        if (bulkActionsBtn) bulkActionsBtn.style.display = \"flex\";\n\n        // Add checkboxes to all task cards\n        document.querySelectorAll(\".task-card\").forEach((card) => {\n          card.classList.add(\"bulk-select-mode\");\n          card.addEventListener(\"click\", toggleTaskSelection);\n        });\n      } else {\n        bulkSelectToggle.innerHTML =\n          '<i class=\"fas fa-check-square\"></i>Bulk Select';\n        bulkSelectToggle.classList.remove(\"btn-danger\");\n        bulkSelectToggle.classList.add(\"btn-info\");\n        if (bulkActionsBtn) bulkActionsBtn.style.display = \"none\";\n\n        // Remove checkboxes\n        document.querySelectorAll(\".task-card\").forEach((card) => {\n          card.classList.remove(\"bulk-select-mode\", \"selected\");\n          card.removeEventListener(\"click\", toggleTaskSelection);\n        });\n\n        selectedTasks.clear();\n      }\n    });\n  }\n\n  function toggleTaskSelection(e) {\n    if (!bulkSelectMode) return;\n    e.stopPropagation();\n\n    const taskCard = e.currentTarget;\n    const taskId = taskCard.dataset.taskId;\n\n    if (selectedTasks.has(taskId)) {\n      selectedTasks.delete(taskId);\n      taskCard.classList.remove(\"selected\");\n    } else {\n      selectedTasks.add(taskId);\n      taskCard.classList.add(\"selected\");\n    }\n\n    updateSelectedCount();\n  }\n\n  function updateSelectedCount() {\n    const selectedCount = document.getElementById(\"selected-count\");\n    if (selectedCount) {\n      selectedCount.textContent = selectedTasks.size;\n    }\n  }\n\n  if (bulkActionsBtn) {\n    bulkActionsBtn.addEventListener(\"click\", () => {\n      updateSelectedCount();\n      openModalEnhanced(bulkActionsModal);\n    });\n  }\n\n  if (closeBulkModal) {\n    closeBulkModal.addEventListener(\"click\", () => {\n      closeModalEnhanced(bulkActionsModal);\n    });\n  }\n\n  // Bulk complete\n  const bulkComplete = document.getElementById(\"bulk-complete\");\n  if (bulkComplete) {\n    bulkComplete.addEventListener(\"click\", () => {\n      selectedTasks.forEach((taskId) => {\n        updateTaskStatus(taskId, \"done\");\n      });\n      showNotificationEnhanced(\n        `${selectedTasks.size} tasks marked as complete`,\n        \"success\",\n        true\n      );\n      closeModalEnhanced(bulkActionsModal);\n      selectedTasks.clear();\n    });\n  }\n\n  // Bulk archive\n  const bulkArchive = document.getElementById(\"bulk-archive\");\n  if (bulkArchive) {\n    bulkArchive.addEventListener(\"click\", () => {\n      selectedTasks.forEach((taskId) => {\n        archiveTaskById(taskId);\n      });\n      showNotificationEnhanced(\n        `${selectedTasks.size} tasks archived`,\n        \"success\",\n        true\n      );\n      closeModalEnhanced(bulkActionsModal);\n      selectedTasks.clear();\n    });\n  }\n\n  // Bulk delete\n  const bulkDelete = document.getElementById(\"bulk-delete\");\n  if (bulkDelete) {\n    bulkDelete.addEventListener(\"click\", () => {\n      if (confirm(`Delete ${selectedTasks.size} tasks?`)) {\n        selectedTasks.forEach((taskId) => {\n          deleteTaskById(taskId);\n        });\n        showNotificationEnhanced(\n          `${selectedTasks.size} tasks deleted`,\n          \"success\",\n          true\n        );\n        closeModalEnhanced(bulkActionsModal);\n        selectedTasks.clear();\n      }\n    });\n  }\n}\n\nfunction updateTaskStatus(taskId, status) {\n  if (currentUser) {\n    db.collection(\"users\")\n      .doc(currentUser.uid)\n      .collection(\"tasks\")\n      .doc(taskId)\n      .update({\n        status: status,\n        updatedAt: firebase.firestore.FieldValue.serverTimestamp(),\n      })\n      .catch((err) => console.error(\"Error updating task:\", err));\n  } else {\n    const task = tasks.find((t) => t.id === taskId);\n    if (task) {\n      task.status = status;\n      saveTasksToLocalStorage();\n      renderTasks();\n      updateStats();\n    }\n  }\n}\n\nfunction archiveTaskById(taskId) {\n  if (currentUser) {\n    db.collection(\"users\")\n      .doc(currentUser.uid)\n      .collection(\"tasks\")\n      .doc(taskId)\n      .update({\n        archived: true,\n        updatedAt: firebase.firestore.FieldValue.serverTimestamp(),\n      })\n      .catch((err) => console.error(\"Error archiving task:\", err));\n  } else {\n    const task = tasks.find((t) => t.id === taskId);\n    if (task) {\n      task.archived = true;\n      saveTasksToLocalStorage();\n      renderTasks();\n      updateStats();\n    }\n  }\n}\n\nfunction deleteTaskById(taskId) {\n  if (currentUser) {\n    db.collection(\"users\")\n      .doc(currentUser.uid)\n      .collection(\"tasks\")\n      .doc(taskId)\n      .delete()\n      .catch((err) => console.error(\"Error deleting task:\", err));\n  } else {\n    tasks = tasks.filter((t) => t.id !== taskId);\n    saveTasksToLocalStorage();\n    renderTasks();\n    updateStats();\n  }\n}\n\n// Request notification permission and setup reminders\nfunction setupReminders() {\n  if (\"Notification\" in window && Notification.permission === \"default\") {\n    Notification.requestPermission().then((permission) => {\n      if (permission === \"granted\") {\n        showNotificationEnhanced(\"Notifications enabled!\", \"success\", true);\n      }\n    });\n  }\n\n  // Check for due reminders every minute\n  setInterval(checkReminders, 60000);\n}\n\nfunction checkReminders() {\n  if (!tasks || tasks.length === 0) return;\n\n  const now = new Date();\n\n  tasks.forEach((task) => {\n    if (\n      task.reminder &&\n      task.reminder !== \"none\" &&\n      task.dueDate &&\n      !task.archived &&\n      task.status !== \"done\"\n    ) {\n      const dueDate = new Date(task.dueDate);\n      const reminderMinutes = parseInt(task.reminder);\n      const reminderTime = new Date(\n        dueDate.getTime() - reminderMinutes * 60000\n      );\n\n      // Check if it's time for reminder (within 1 minute window)\n      if (\n        now >= reminderTime &&\n        now < new Date(reminderTime.getTime() + 60000)\n      ) {\n        sendNotification(task);\n      }\n    }\n  });\n}\n\nfunction sendNotification(task) {\n  if (\"Notification\" in window && Notification.permission === \"granted\") {\n    new Notification(\"Task Reminder\", {\n      body: `${task.title} is due soon!`,\n      icon: \"favicon.ico\",\n      tag: task.id,\n    });\n  }\n\n  showNotificationEnhanced(`Reminder: ${task.title}`, \"warning\", true);\n}\n\n// ========== TASK CARD DISPLAY FIXES ==========\n\n// Enhanced task card rendering with proper tags, importance, and difficulty display\nfunction createTaskCardEnhanced(task) {\n  const card = document.createElement(\"div\");\n  card.className = \"task-card\";\n  card.dataset.taskId = task.id;\n  card.draggable = true;\n\n  // Add priority border\n  if (task.importance === 3) {\n    card.classList.add(\"task-card-priority-high\");\n  } else if (task.importance === 2) {\n    card.classList.add(\"task-card-priority-medium\");\n  } else {\n    card.classList.add(\"task-card-priority-low\");\n  }\n\n  // Check if overdue\n  const isOverdue =\n    task.dueDate &&\n    new Date(task.dueDate) < new Date() &&\n    task.status !== \"done\";\n\n  card.innerHTML = `\n    <div class=\"task-header\">\n      <h3 class=\"task-title\">${task.title}</h3>\n      <span class=\"task-difficulty ${task.difficulty}\">${task.difficulty}</span>\n    </div>\n    \n    ${\n      task.description\n        ? `<p class=\"task-description\">${task.description}</p>`\n        : \"\"\n    }\n    \n    <div class=\"task-meta\">\n      <span class=\"task-date\">\n        <i class=\"fas fa-calendar\"></i> ${\n          task.dueDate ? new Date(task.dueDate).toLocaleDateString() : \"No date\"\n        }\n      </span>\n      <div class=\"task-importance\" data-importance=\"${task.importance}\">\n        ${task.importance}\n      </div>\n    </div>\n    \n    ${\n      task.tags && task.tags.length > 0\n        ? `\n      <div class=\"task-tags\">\n        ${task.tags\n          .map((tag) => {\n            const tagColor = getTagColor(tag);\n            return `<span class=\"task-tag\" style=\"background-color: ${tagColor}\">${tag}</span>`;\n          })\n          .join(\"\")}\n      </div>\n    `\n        : \"\"\n    }\n    \n    ${\n      task.checkpoints && task.checkpoints.length > 0\n        ? `\n      <div class=\"task-progress\">\n        <div class=\"progress-bar\">\n          <div class=\"progress-fill\" style=\"width: ${\n            task.progress || 0\n          }%\"></div>\n        </div>\n        <div class=\"progress-text\">${task.progress || 0}% Complete</div>\n      </div>\n    `\n        : \"\"\n    }\n    \n    ${\n      isOverdue\n        ? '<div class=\"task-overdue-badge\"><i class=\"fas fa-clock\"></i> Overdue</div>'\n        : \"\"\n    }\n    \n    <div class=\"task-actions\">\n      <button class=\"btn-success btn-sm\" onclick=\"markTaskComplete('${\n        task.id\n      }')\">\n        <i class=\"fas fa-check\"></i>\n      </button>\n      <button class=\"btn-info btn-sm\" onclick=\"editTask('${task.id}')\">\n        <i class=\"fas fa-edit\"></i>\n      </button>\n      <button class=\"btn-danger btn-sm\" onclick=\"deleteTaskConfirm('${\n        task.id\n      }')\">\n        <i class=\"fas fa-trash\"></i>\n      </button>\n    </div>\n  `;\n\n  // Add click handler to open task modal\n  card.addEventListener(\"click\", (e) => {\n    if (\n      !e.target.closest(\"button\") &&\n      !card.classList.contains(\"bulk-select-mode\")\n    ) {\n      openTaskModal(task.id);\n    }\n  });\n\n  return card;\n}\n\n// Get tag color from custom tags or default colors\nfunction getTagColor(tagName) {\n  const customTags = JSON.parse(localStorage.getItem(\"customTags\") || \"[]\");\n  const customTag = customTags.find((t) => t.name === tagName);\n\n  if (customTag) {\n    return customTag.color;\n  }\n\n  // Default colors for built-in tags\n  const defaultColors = {\n    Work: \"#0984e3\",\n    Personal: \"#00b894\",\n    Urgent: \"#d63031\",\n    Important: \"#fdcb6e\",\n    \"Low Priority\": \"#74b9ff\",\n  };\n\n  return defaultColors[tagName] || \"#6c5ce7\";\n}\n\n// Add CSS for overdue badge and enhanced styling\nconst overdueStyles = `\n<style>\n.task-overdue-badge {\n  background-color: var(--danger);\n  color: white;\n  padding: 5px 10px;\n  border-radius: 5px;\n  font-size: 0.85rem;\n  margin-top: 10px;\n  display: inline-flex;\n  align-items: center;\n  gap: 5px;\n  animation: pulse 2s ease-in-out infinite;\n}\n\n.btn-sm {\n  padding: 6px 10px;\n  font-size: 0.85rem;\n}\n\n.task-card-priority-high {\n  border-left: 4px solid var(--danger);\n}\n\n.task-card-priority-medium {\n  border-left: 4px solid var(--warning);\n}\n\n.task-card-priority-low {\n  border-left: 4px solid var(--success);\n}\n\n/* Better tag styling */\n.task-tag {\n  padding: 6px 14px;\n  border-radius: 20px;\n  font-size: 0.85rem;\n  font-weight: 600;\n  color: white;\n  transition: var(--transition);\n  display: inline-flex;\n  align-items: center;\n  gap: 5px;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n}\n\n.task-tag:hover {\n  transform: scale(1.05);\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);\n}\n\n/* Improved difficulty badges */\n.task-difficulty {\n  padding: 5px 12px;\n  border-radius: 20px;\n  font-size: 0.8rem;\n  font-weight: 600;\n  white-space: nowrap;\n  text-transform: capitalize;\n}\n\n.task-difficulty.easy {\n  background-color: rgba(0, 184, 148, 0.2);\n  color: var(--easy);\n  border: 2px solid var(--easy);\n}\n\n.task-difficulty.medium {\n  background-color: rgba(253, 203, 110, 0.2);\n  color: var(--warning);\n  border: 2px solid var(--warning);\n}\n\n.task-difficulty.hard {\n  background-color: rgba(214, 48, 49, 0.2);\n  color: var(--danger);\n  border: 2px solid var(--danger);\n}\n\n/* Improved importance badge */\n.task-importance {\n  width: 30px;\n  height: 30px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  font-weight: 700;\n  font-size: 0.9rem;\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);\n}\n\n.task-importance[data-importance=\"1\"] {\n  background: linear-gradient(135deg, #74b9ff, #0984e3);\n}\n\n.task-importance[data-importance=\"2\"] {\n  background: linear-gradient(135deg, #a29bfe, #6c5ce7);\n}\n\n.task-importance[data-importance=\"3\"] {\n  background: linear-gradient(135deg, #ff7675, #d63031);\n  animation: pulse 2s ease-in-out infinite;\n}\n</style>\n`;\n\n// Inject styles\nif (!document.getElementById(\"task-card-enhanced-styles\")) {\n  const styleElement = document.createElement(\"div\");\n  styleElement.id = \"task-card-enhanced-styles\";\n  styleElement.innerHTML = overdueStyles;\n  document.head.appendChild(styleElement);\n}\n\n// Helper functions for task actions\nfunction markTaskComplete(taskId) {\n  updateTaskStatus(taskId, \"done\");\n  showNotificationEnhanced(\"Task marked as complete!\", \"success\", true);\n}\n\nfunction editTask(taskId) {\n  const task = tasks.find((t) => t.id === taskId);\n  if (task) {\n    currentEditingTaskId = taskId;\n    openTaskModal(taskId);\n  }\n}\n\nfunction deleteTaskConfirm(taskId) {\n  if (confirm(\"Are you sure you want to delete this task?\")) {\n    deleteTaskById(taskId);\n    showNotificationEnhanced(\"Task deleted!\", \"success\", true);\n  }\n}\n\nfunction openTaskModal(taskId) {\n  const task = tasks.find((t) => t.id === taskId);\n  if (!task) return;\n\n  currentEditingTaskId = taskId;\n\n  // Populate modal fields\n  const modalTaskTitle = document.getElementById(\"modal-task-title\");\n  const modalTaskDescription = document.getElementById(\n    \"modal-task-description\"\n  );\n  const modalTaskDueDate = document.getElementById(\"modal-task-due-date\");\n  const modalTaskDifficulty = document.getElementById(\"modal-task-difficulty\");\n  const modalTaskTags = document.getElementById(\"modal-task-tags\");\n  const modalTaskReminder = document.getElementById(\"modal-task-reminder\");\n  const modalTaskRecurrence = document.getElementById(\"modal-task-recurrence\");\n  const modalTaskStartTime = document.getElementById(\"modal-task-start-time\");\n  const modalTaskEndTime = document.getElementById(\"modal-task-end-time\");\n\n  if (modalTaskTitle) modalTaskTitle.value = task.title || \"\";\n  if (modalTaskDescription) modalTaskDescription.value = task.description || \"\";\n  if (modalTaskDueDate) modalTaskDueDate.value = task.dueDate || \"\";\n  if (modalTaskDifficulty)\n    modalTaskDifficulty.value = task.difficulty || \"easy\";\n  if (modalTaskReminder) modalTaskReminder.value = task.reminder || \"none\";\n  if (modalTaskRecurrence)\n    modalTaskRecurrence.value = task.recurrence || \"none\";\n  if (modalTaskStartTime) modalTaskStartTime.value = task.startTime || \"\";\n  if (modalTaskEndTime) modalTaskEndTime.value = task.endTime || \"\";\n\n  // Set tags\n  if (modalTaskTags && task.tags) {\n    Array.from(modalTaskTags.options).forEach((option) => {\n      option.selected = task.tags.includes(option.value);\n    });\n  }\n\n  // Set importance\n  const importanceOptions = document.querySelectorAll(\n    \"#task-modal-overlay .importance-option\"\n  );\n  importanceOptions.forEach((option) => {\n    option.classList.remove(\"selected\");\n    if (parseInt(option.dataset.importance) === task.importance) {\n      option.classList.add(\"selected\");\n    }\n  });\n\n  // Populate checkpoints\n  const modalCheckpoints = document.getElementById(\"modal-checkpoints\");\n  if (modalCheckpoints && task.checkpoints) {\n    modalCheckpoints.innerHTML = task.checkpoints\n      .map(\n        (cp, index) => `\n      <div class=\"checkpoint-item ${cp.completed ? \"completed\" : \"\"}\">\n        <input type=\"checkbox\" ${cp.completed ? \"checked\" : \"\"} \n               onchange=\"toggleCheckpoint('${taskId}', ${index})\">\n        <span class=\"checkpoint-text\">${cp.text}</span>\n      </div>\n    `\n      )\n      .join(\"\");\n  }\n\n  // Open modal\n  const taskModal = document.getElementById(\"task-modal-overlay\");\n  openModalEnhanced(taskModal);\n}\n\nfunction toggleCheckpoint(taskId, checkpointIndex) {\n  const task = tasks.find((t) => t.id === taskId);\n  if (!task || !task.checkpoints) return;\n\n  task.checkpoints[checkpointIndex].completed =\n    !task.checkpoints[checkpointIndex].completed;\n\n  // Recalculate progress\n  const completedCount = task.checkpoints.filter((cp) => cp.completed).length;\n  task.progress = Math.round((completedCount / task.checkpoints.length) * 100);\n\n  // Update in database\n  if (currentUser) {\n    db.collection(\"users\")\n      .doc(currentUser.uid)\n      .collection(\"tasks\")\n      .doc(taskId)\n      .update({\n        checkpoints: task.checkpoints,\n        progress: task.progress,\n        updatedAt: firebase.firestore.FieldValue.serverTimestamp(),\n      })\n      .catch((err) => console.error(\"Error updating checkpoint:\", err));\n  } else {\n    saveTasksToLocalStorage();\n    renderTasks();\n    updateStats();\n  }\n}\n\n// Initialize everything on DOM load\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  console.log(\"Initializing enhancements...\");\n\n  // Load settings\n  loadAppSettings();\n\n  // Setup profile picture\n  setupProfilePicture();\n\n  // Setup bulk actions\n  setupBulkActions();\n\n  // Setup reminders\n  setupReminders();\n\n  // Override save settings button\n  const saveSettingsBtn = document.getElementById(\"save-settings\");\n  if (saveSettingsBtn) {\n    // Remove old listener and add new one\n    const newSaveSettingsBtn = saveSettingsBtn.cloneNode(true);\n    saveSettingsBtn.parentNode.replaceChild(\n      newSaveSettingsBtn,\n      saveSettingsBtn\n    );\n    newSaveSettingsBtn.addEventListener(\"click\", saveSettingsEnhanced);\n  }\n\n  console.log(\"All enhancements initialized successfully!\");\n});\n\nconsole.log(\"Task card enhancements loaded!\");\n\n// ========== CUSTOM TAGS INPUT SYSTEM ==========\n\n// Store for all tags (common tags + user-created tags)\nlet allTags = [\"Work\", \"Personal\", \"Urgent\", \"Important\", \"Low Priority\"];\nlet currentTaskTags = [];\nlet currentModalTags = [];\n\n// Load saved tags from localStorage\nfunction loadSavedTags() {\n  const savedTags = localStorage.getItem(\"allTags\");\n  if (savedTags) {\n    allTags = JSON.parse(savedTags);\n  }\n}\n\n// Save tags to localStorage\nfunction saveTags() {\n  localStorage.setItem(\"allTags\", JSON.stringify(allTags));\n}\n\n// Setup tags input for main form\nfunction setupTagsInput() {\n  const tagsInput = document.getElementById(\"task-tags-input\");\n  const selectedTagsContainer = document.getElementById(\"selected-tags\");\n  const suggestionsContainer = document.getElementById(\"tags-suggestions\");\n\n  if (!tagsInput) return;\n\n  // Show suggestions on focus\n  tagsInput.addEventListener(\"focus\", () => {\n    showSuggestions(suggestionsContainer, currentTaskTags, (tag) => {\n      addTag(tag, selectedTagsContainer, currentTaskTags);\n      tagsInput.value = \"\";\n      updateSuggestions(suggestionsContainer, currentTaskTags);\n    });\n  });\n\n  // Filter suggestions as user types\n  tagsInput.addEventListener(\"input\", (e) => {\n    const value = e.target.value.trim();\n    if (value) {\n      const filtered = allTags.filter(\n        (tag) =>\n          tag.toLowerCase().includes(value.toLowerCase()) &&\n          !currentTaskTags.includes(tag)\n      );\n      showFilteredSuggestions(\n        suggestionsContainer,\n        filtered,\n        currentTaskTags,\n        (tag) => {\n          addTag(tag, selectedTagsContainer, currentTaskTags);\n          tagsInput.value = \"\";\n          updateSuggestions(suggestionsContainer, currentTaskTags);\n        }\n      );\n    } else {\n      updateSuggestions(suggestionsContainer, currentTaskTags);\n    }\n  });\n\n  // Add tag on Enter\n  tagsInput.addEventListener(\"keydown\", (e) => {\n    if (e.key === \"Enter\") {\n      e.preventDefault();\n      const value = tagsInput.value.trim();\n      if (value) {\n        // Add to allTags if it's new\n        if (!allTags.includes(value)) {\n          allTags.push(value);\n          saveTags();\n        }\n        addTag(value, selectedTagsContainer, currentTaskTags);\n        tagsInput.value = \"\";\n        updateSuggestions(suggestionsContainer, currentTaskTags);\n      }\n    }\n  });\n\n  // Hide suggestions when clicking outside\n  document.addEventListener(\"click\", (e) => {\n    if (\n      !e.target.closest(\".tags-input-container\") &&\n      !e.target.closest(\".tags-suggestions\")\n    ) {\n      suggestionsContainer.classList.remove(\"show\");\n    }\n  });\n}\n\n// Setup tags input for modal\nfunction setupModalTagsInput() {\n  const tagsInput = document.getElementById(\"modal-task-tags-input\");\n  const selectedTagsContainer = document.getElementById(\"modal-selected-tags\");\n  const suggestionsContainer = document.getElementById(\n    \"modal-tags-suggestions\"\n  );\n\n  if (!tagsInput) return;\n\n  // Show suggestions on focus\n  tagsInput.addEventListener(\"focus\", () => {\n    showSuggestions(suggestionsContainer, currentModalTags, (tag) => {\n      addTag(tag, selectedTagsContainer, currentModalTags);\n      tagsInput.value = \"\";\n      updateSuggestions(suggestionsContainer, currentModalTags);\n    });\n  });\n\n  // Filter suggestions as user types\n  tagsInput.addEventListener(\"input\", (e) => {\n    const value = e.target.value.trim();\n    if (value) {\n      const filtered = allTags.filter(\n        (tag) =>\n          tag.toLowerCase().includes(value.toLowerCase()) &&\n          !currentModalTags.includes(tag)\n      );\n      showFilteredSuggestions(\n        suggestionsContainer,\n        filtered,\n        currentModalTags,\n        (tag) => {\n          addTag(tag, selectedTagsContainer, currentModalTags);\n          tagsInput.value = \"\";\n          updateSuggestions(suggestionsContainer, currentModalTags);\n        }\n      );\n    } else {\n      updateSuggestions(suggestionsContainer, currentModalTags);\n    }\n  });\n\n  // Add tag on Enter\n  tagsInput.addEventListener(\"keydown\", (e) => {\n    if (e.key === \"Enter\") {\n      e.preventDefault();\n      const value = tagsInput.value.trim();\n      if (value) {\n        // Add to allTags if it's new\n        if (!allTags.includes(value)) {\n          allTags.push(value);\n          saveTags();\n        }\n        addTag(value, selectedTagsContainer, currentModalTags);\n        tagsInput.value = \"\";\n        updateSuggestions(suggestionsContainer, currentModalTags);\n      }\n    }\n  });\n}\n\n// Add a tag to the selected tags\nfunction addTag(tag, container, tagsArray) {\n  if (tagsArray.includes(tag)) return;\n\n  tagsArray.push(tag);\n\n  const tagElement = document.createElement(\"div\");\n  tagElement.className = \"tag-item-input\";\n  tagElement.innerHTML = `\n    <span>${tag}</span>\n    <button class=\"tag-remove\" type=\"button\">\u00D7</button>\n  `;\n\n  tagElement.querySelector(\".tag-remove\").addEventListener(\"click\", () => {\n    const index = tagsArray.indexOf(tag);\n    if (index > -1) {\n      tagsArray.splice(index, 1);\n    }\n    tagElement.remove();\n  });\n\n  container.appendChild(tagElement);\n}\n\n// Show all suggestions\nfunction showSuggestions(container, currentTags, onSelect) {\n  container.innerHTML = \"\";\n  const availableTags = allTags.filter((tag) => !currentTags.includes(tag));\n\n  availableTags.forEach((tag) => {\n    const suggestion = document.createElement(\"div\");\n    suggestion.className = \"tag-suggestion\";\n    suggestion.textContent = tag;\n    suggestion.addEventListener(\"click\", () => onSelect(tag));\n    container.appendChild(suggestion);\n  });\n\n  if (availableTags.length > 0) {\n    container.classList.add(\"show\");\n  }\n}\n\n// Show filtered suggestions\nfunction showFilteredSuggestions(container, filtered, currentTags, onSelect) {\n  container.innerHTML = \"\";\n\n  filtered.forEach((tag) => {\n    const suggestion = document.createElement(\"div\");\n    suggestion.className = \"tag-suggestion\";\n    suggestion.textContent = tag;\n    suggestion.addEventListener(\"click\", () => onSelect(tag));\n    container.appendChild(suggestion);\n  });\n\n  if (filtered.length > 0) {\n    container.classList.add(\"show\");\n  } else {\n    container.classList.remove(\"show\");\n  }\n}\n\n// Update suggestions\nfunction updateSuggestions(container, currentTags) {\n  const availableTags = allTags.filter((tag) => !currentTags.includes(tag));\n  if (availableTags.length === 0) {\n    container.classList.remove(\"show\");\n  }\n}\n\n// Get current tags from form\nfunction getCurrentTags() {\n  return [...currentTaskTags];\n}\n\n// Get current tags from modal\nfunction getCurrentModalTags() {\n  return [...currentModalTags];\n}\n\n// Clear tags in main form\nfunction clearFormTags() {\n  currentTaskTags = [];\n  const container = document.getElementById(\"selected-tags\");\n  if (container) container.innerHTML = \"\";\n}\n\n// Set tags in modal\nfunction setModalTags(tags) {\n  currentModalTags = [];\n  const container = document.getElementById(\"modal-selected-tags\");\n  if (container) {\n    container.innerHTML = \"\";\n    tags.forEach((tag) => addTag(tag, container, currentModalTags));\n  }\n}\n\n// Initialize tags system\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  loadSavedTags();\n  setupTagsInput();\n  setupModalTagsInput();\n  console.log(\"Custom tags system initialized!\");\n});\n\nconsole.log(\"Custom tags input system loaded!\");\n"],
  "mappings": "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",
  "names": ["firebaseConfig", "error", "db", "auth", "tasks", "currentEditingTaskId", "currentUser", "currentView", "currentMonth", "currentYear", "currentFilter", "currentTagFilter", "currentSort", "searchQuery", "elements", "init", "setupEventListeners", "today", "loadTasksFromLocalStorage", "renderTasks", "updateStats", "setupDragAndDrop", "checkAuthState", "loadSettings", "generateCalendar", "initCharts", "addTask", "saveTask", "toggleForm", "btn", "closeAllModals", "closeModal", "updateTask", "deleteTask", "archiveTask", "toggleView", "openModal", "currentTheme", "showArchivedTasks", "exportTasks", "importTasks", "archiveCompletedTasks", "filterTasks", "clearCompletedTasks", "loginUser", "registerUser", "switchAuthForm", "signInWithGoogle", "saveSettings", "updateProfile", "logoutUser", "changeMonth", "filterAndRenderTasks", "option", "selectImportance", "handleKeyboardShortcuts", "user", "loadTasks", "showNotification", "snapshot", "doc", "task", "updateCharts", "title", "description", "dueDate", "startTime", "endTime", "recurrence", "difficulty", "reminder", "selectedImportance", "importance", "checkpointsText", "checkpoints", "cp", "selectedTags", "getCurrentTags", "progress", "docRef", "resetForm", "saveTasksToLocalStorage", "updatedTask", "taskIndex", "getCurrentModalTags", "el", "checkbox", "text", "completedTasks", "batch", "tasksRef", "taskRef", "archivedTasks", "taskElement", "createArchivedTaskElement", "restoreTask", "taskId", "filter", "filteredTasks", "tag", "a", "b", "tasksToRender", "activeTasks", "todoTasks", "inProgressTasks", "doneTasks", "createTaskElement", "isOverdue", "checkpointsHTML", "completedCount", "tagsHTML", "getTagColor", "editTaskById", "completeTask", "handleDragStart", "handleDragEnd", "t", "openTaskModal", "completeTask", "taskId", "task", "tasks", "t", "updateTaskStatus", "showNotification", "setupDragAndDrop", "list", "handleDragOver", "handleDragEnter", "handleDragLeave", "handleDrop", "handleDragStart", "handleDragEnd", "newStatus", "resetForm", "elements", "option", "clearFormTags", "currentEditingTaskId", "validatePasswordRequirements", "password", "confirmPassword", "requirements", "signupPassword", "signupConfirmPassword", "validatePasswordRequirements", "toggleForm", "formContent", "elements", "toggleView", "currentView", "elements", "generateCalendar", "currentMonth", "currentYear", "month", "year", "monthNames", "firstDay", "daysInMonth", "prevMonthDays", "day", "dayHeader", "i", "emptyDay", "dayNum", "today", "dayElement", "currentDate", "dayDate", "dayOfWeek", "dayNumber", "dayTasks", "tasks", "task", "tasksContainer", "taskElement", "importanceIndicator", "taskTitle", "e", "editTask", "moreIndicator", "showDayTasks", "showNotification", "remainingCells", "nextMonthDay", "date", "formattedDate", "modal", "tag", "tagConfig", "customTags", "t", "item", "taskId", "changeMonth", "direction", "updateStats", "total", "completed", "inProgress", "overdue", "overallProgress", "updateCharts", "initCharts", "completionCanvas", "completionCtx", "statusCanvas", "statusCtx", "weeklyCanvas", "weeklyCtx", "chartsSection", "error", "updateCharts", "todoCount", "tasks", "task", "inProgressCount", "doneCount", "completionData", "getWeeklyCompletionData", "weeklyData", "getMonthlyProductivityData", "error", "today", "weekData", "taskDate", "daysDiff", "monthData", "weekIndex", "exportTasks", "dataStr", "dataUri", "exportFileDefaultName", "linkElement", "showNotification", "importTasks", "file", "reader", "e", "importedTasks", "currentUser", "batch", "db", "tasksRef", "taskRef", "saveTasksToLocalStorage", "renderTasks", "updateStats", "loadTasksFromLocalStorage", "storedTasks", "loadSettings", "savedTheme", "savedView", "currentView", "elements", "defaultTheme", "defaultView", "reduceMotion", "disableAnimations", "saveSettings", "selectedTheme", "applyTheme", "closeModal", "selectImportance", "option", "options", "opt", "openModal", "modal", "closeAllModals", "message", "type", "handleKeyboardShortcuts", "currentTheme", "switchAuthForm", "form", "loginUser", "email", "password", "auth", "userCredential", "registerUser", "username", "confirmPassword", "signInWithGoogle", "provider", "result", "updateProfile", "displayName", "newPassword", "promises", "logoutUser", "init", "currentLayout", "currentDensity", "bulkSelectMode", "selectedTasks", "advancedFilters", "theme", "body", "btn", "switchLayout", "layout", "renderListView", "renderGridView", "renderTimelineView", "applyDensity", "density", "container", "activeTasks", "item", "priorityClass", "updateTaskStatus", "editTask", "card", "createTaskElement", "a", "b", "toggleBtn", "content", "applyBtn", "clearBtn", "isHidden", "applyAdvancedFilters", "filterAndRenderTasks", "filteredTasks", "bulkToggleBtn", "bulkActionsBtn", "handleBulkSelect", "taskId", "archiveTaskById", "showConfirmation", "moveToTrash", "t", "restoreFromTrash", "showTrash", "emptyTrash", "trashedTasks", "taskElement", "permanentlyDeleteTask", "onboardingStep", "totalOnboardingSteps", "nextOnboardingStep", "prevOnboardingStep", "finishOnboarding", "updateOnboardingStep", "step", "index", "dot", "title", "onConfirm", "dialog", "confirmBtn", "cancelBtn", "handleConfirm", "handleCancel", "isCollapsed", "checkSmartReminders", "now", "threeDaysAgo", "detectUrgency", "description", "urgentKeywords", "lowerDesc", "keyword", "customTags", "saveCustomTags", "updateTagsFilter", "updateTaskTagsOptions", "tagsFilter", "tag", "select", "selectedValues", "o", "showTagsManager", "tagsList", "tagItem", "deleteTag", "addTag", "originalCreateTaskElement", "tagsContainer", "tagName", "tagConfig", "tagElement", "metaDiv", "iconsDiv", "difficultyIcon", "importanceIcon", "overdueIcon", "taskForm", "startTimeInput", "endTimeInput", "dueDateInput", "validateTimeRange", "start", "selectedDate", "helpTabs", "helpTabContents", "tab", "targetTab", "appSettings", "loadAppSettings", "savedSettings", "reduceNotifCheckbox", "disableNotifCheckbox", "saveSettingsEnhanced", "reduceNotifications", "disableNotifications", "applyThemeEnhanced", "applyDefaultView", "style", "existingStyle", "err", "showNotificationEnhanced", "view", "kanbanView", "calendarView", "viewToggle", "isImportant", "notification", "notificationIcon", "notificationMessage", "setupProfilePicture", "profilePicture", "profilePictureUpload", "changeProfilePictureBtn", "event", "savedPicture", "openModalEnhanced", "closeModalEnhanced", "setupBulkActions", "bulkSelectToggle", "bulkActionsModal", "closeBulkModal", "toggleTaskSelection", "taskCard", "updateSelectedCount", "selectedCount", "bulkComplete", "bulkArchive", "bulkDelete", "deleteTaskById", "status", "setupReminders", "permission", "checkReminders", "dueDate", "reminderMinutes", "reminderTime", "sendNotification", "getTagColor", "tagName", "customTag", "t", "overdueStyles", "styleElement", "editTask", "taskId", "tasks", "t", "currentEditingTaskId", "openTaskModal", "openTaskModal", "taskId", "task", "tasks", "t", "currentEditingTaskId", "modalTaskTitle", "modalTaskDescription", "modalTaskDueDate", "modalTaskDifficulty", "modalTaskTags", "modalTaskReminder", "modalTaskRecurrence", "modalTaskStartTime", "modalTaskEndTime", "option", "modalCheckpoints", "cp", "index", "taskModal", "openModalEnhanced", "loadAppSettings", "setupProfilePicture", "setupBulkActions", "setupReminders", "saveSettingsBtn", "newSaveSettingsBtn", "saveSettingsEnhanced", "allTags", "currentTaskTags", "currentModalTags", "loadSavedTags", "savedTags", "saveTags", "setupTagsInput", "tagsInput", "selectedTagsContainer", "suggestionsContainer", "showSuggestions", "tag", "addTag", "updateSuggestions", "e", "value", "filtered", "showFilteredSuggestions", "setupModalTagsInput", "container", "tagsArray", "tagElement", "index", "currentTags", "onSelect", "availableTags", "suggestion", "getCurrentTags", "getCurrentModalTags", "clearFormTags", "loadSavedTags", "setupTagsInput", "setupModalTagsInput"]
}
